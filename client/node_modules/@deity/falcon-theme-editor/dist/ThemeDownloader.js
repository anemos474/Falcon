"use strict";

var _interopRequireDefault = /*#__PURE__*/require("@babel/runtime/helpers/interopRequireDefault");

exports.__esModule = true;
exports.ThemeDownloader = void 0;

var _react = /*#__PURE__*/_interopRequireDefault( /*#__PURE__*/require("react"));

var _deepObjectDiff = /*#__PURE__*/require("deep-object-diff");

var _falconUi = /*#__PURE__*/require("@deity/falcon-ui");

var CREATE_THEME_IMPORT = "import { createTheme } from '@deity/falcon-ui';";

function getThemeCustomizations(initialTheme, currentTheme) {
  var themeDiff = (0, _deepObjectDiff.diff)(initialTheme, currentTheme);
  return JSON.stringify(themeDiff, null, 2);
}

function withExports(customizationsSerialized) {
  return CREATE_THEME_IMPORT + "\n\nexport const theme = createTheme(" + customizationsSerialized + ");";
}

function copyToClipboard(serializedCustomizations) {
  window.navigator.clipboard.writeText(withExports(serializedCustomizations));
}

function download(serializedCustomizations) {
  var customizations = withExports(serializedCustomizations);
  var data = "data:text/json;charset=utf-8," + encodeURIComponent(customizations);
  var downloader = document.createElement('a');
  downloader.setAttribute('href', data);
  downloader.setAttribute('download', 'theme.js');
  downloader.click();
}

var ThemeDownloader = function ThemeDownloader(_ref) {
  var initialTheme = _ref.initialTheme,
      currentTheme = _ref.currentTheme;
  var serializedCustomizations = getThemeCustomizations(initialTheme, currentTheme);

  if (serializedCustomizations === '{}') {
    return /*#__PURE__*/_react.default.createElement(_falconUi.Text, {
      fontSize: "md"
    }, "Nothing to download yet, try making few customizations first!");
  }

  return /*#__PURE__*/_react.default.createElement(_falconUi.FlexLayout, {
    css: {
      height: '100%'
    },
    flexDirection: "column"
  }, /*#__PURE__*/_react.default.createElement(_falconUi.FlexLayout, {
    mb: "sm"
  }, /*#__PURE__*/_react.default.createElement(_falconUi.Button, {
    mr: "xs",
    flex: "1",
    onClick: function onClick() {
      return copyToClipboard(serializedCustomizations);
    }
  }, /*#__PURE__*/_react.default.createElement(_falconUi.Icon, {
    stroke: "white",
    src: "copy",
    size: "md",
    mr: "sm"
  }), "Copy"), /*#__PURE__*/_react.default.createElement(_falconUi.Button, {
    ml: "xs",
    flex: "1",
    onClick: function onClick() {
      return download(serializedCustomizations);
    }
  }, /*#__PURE__*/_react.default.createElement(_falconUi.Icon, {
    size: "md",
    mr: "sm",
    stroke: "white",
    css: {
      strokeWidth: '4'
    },
    src: "download"
  }), "Download")), /*#__PURE__*/_react.default.createElement(_falconUi.Input, {
    as: "textarea",
    flex: "1",
    spellCheck: false,
    readOnly: true,
    value: serializedCustomizations
  }));
};

exports.ThemeDownloader = ThemeDownloader;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9UaGVtZURvd25sb2FkZXIudHN4Il0sIm5hbWVzIjpbIkNSRUFURV9USEVNRV9JTVBPUlQiLCJnZXRUaGVtZUN1c3RvbWl6YXRpb25zIiwiaW5pdGlhbFRoZW1lIiwiY3VycmVudFRoZW1lIiwidGhlbWVEaWZmIiwiSlNPTiIsInN0cmluZ2lmeSIsIndpdGhFeHBvcnRzIiwiY3VzdG9taXphdGlvbnNTZXJpYWxpemVkIiwiY29weVRvQ2xpcGJvYXJkIiwic2VyaWFsaXplZEN1c3RvbWl6YXRpb25zIiwid2luZG93IiwibmF2aWdhdG9yIiwiY2xpcGJvYXJkIiwid3JpdGVUZXh0IiwiZG93bmxvYWQiLCJjdXN0b21pemF0aW9ucyIsImRhdGEiLCJlbmNvZGVVUklDb21wb25lbnQiLCJkb3dubG9hZGVyIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiY2xpY2siLCJUaGVtZURvd25sb2FkZXIiLCJoZWlnaHQiLCJzdHJva2VXaWR0aCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUVBLElBQU1BLG1CQUFtQixHQUFHLGlEQUE1Qjs7QUFFQSxTQUFTQyxzQkFBVCxDQUFnQ0MsWUFBaEMsRUFBcURDLFlBQXJELEVBQTBFO0FBQ3hFLE1BQU1DLFNBQVMsR0FBRywwQkFBS0YsWUFBTCxFQUE2QkMsWUFBN0IsQ0FBbEI7QUFFQSxTQUFPRSxJQUFJLENBQUNDLFNBQUwsQ0FBZUYsU0FBZixFQUEwQixJQUExQixFQUFnQyxDQUFoQyxDQUFQO0FBQ0Q7O0FBRUQsU0FBU0csV0FBVCxDQUFxQkMsd0JBQXJCLEVBQXVEO0FBQ3JELFNBQVVSLG1CQUFWLDZDQUFxRVEsd0JBQXJFO0FBQ0Q7O0FBT0QsU0FBU0MsZUFBVCxDQUF5QkMsd0JBQXpCLEVBQTJEO0FBQ3hEQyxFQUFBQSxNQUFNLENBQUNDLFNBQVIsQ0FBMEJDLFNBQTFCLENBQW9DQyxTQUFwQyxDQUE4Q1AsV0FBVyxDQUFDRyx3QkFBRCxDQUF6RDtBQUNEOztBQUVELFNBQVNLLFFBQVQsQ0FBa0JMLHdCQUFsQixFQUFvRDtBQUNsRCxNQUFNTSxjQUFjLEdBQUdULFdBQVcsQ0FBQ0csd0JBQUQsQ0FBbEM7QUFDQSxNQUFNTyxJQUFJLHFDQUFtQ0Msa0JBQWtCLENBQUNGLGNBQUQsQ0FBL0Q7QUFFQSxNQUFNRyxVQUFVLEdBQUdDLFFBQVEsQ0FBQ0MsYUFBVCxDQUF1QixHQUF2QixDQUFuQjtBQUVBRixFQUFBQSxVQUFVLENBQUNHLFlBQVgsQ0FBd0IsTUFBeEIsRUFBZ0NMLElBQWhDO0FBQ0FFLEVBQUFBLFVBQVUsQ0FBQ0csWUFBWCxDQUF3QixVQUF4QixFQUFvQyxVQUFwQztBQUNBSCxFQUFBQSxVQUFVLENBQUNJLEtBQVg7QUFDRDs7QUFFTSxJQUFNQyxlQUFnRCxHQUFHLFNBQW5EQSxlQUFtRCxPQUFvQztBQUFBLE1BQWpDdEIsWUFBaUMsUUFBakNBLFlBQWlDO0FBQUEsTUFBbkJDLFlBQW1CLFFBQW5CQSxZQUFtQjtBQUNsRyxNQUFNTyx3QkFBd0IsR0FBR1Qsc0JBQXNCLENBQUNDLFlBQUQsRUFBZUMsWUFBZixDQUF2RDs7QUFDQSxNQUFJTyx3QkFBd0IsS0FBSyxJQUFqQyxFQUF1QztBQUNyQyx3QkFBTyw2QkFBQyxjQUFEO0FBQU0sTUFBQSxRQUFRLEVBQUM7QUFBZix1RUFBUDtBQUNEOztBQUVELHNCQUNFLDZCQUFDLG9CQUFEO0FBQVksSUFBQSxHQUFHLEVBQUU7QUFBRWUsTUFBQUEsTUFBTSxFQUFFO0FBQVYsS0FBakI7QUFBcUMsSUFBQSxhQUFhLEVBQUM7QUFBbkQsa0JBQ0UsNkJBQUMsb0JBQUQ7QUFBWSxJQUFBLEVBQUUsRUFBQztBQUFmLGtCQUNFLDZCQUFDLGdCQUFEO0FBQVEsSUFBQSxFQUFFLEVBQUMsSUFBWDtBQUFnQixJQUFBLElBQUksRUFBQyxHQUFyQjtBQUF5QixJQUFBLE9BQU8sRUFBRTtBQUFBLGFBQU1oQixlQUFlLENBQUNDLHdCQUFELENBQXJCO0FBQUE7QUFBbEMsa0JBQ0UsNkJBQUMsY0FBRDtBQUFNLElBQUEsTUFBTSxFQUFDLE9BQWI7QUFBcUIsSUFBQSxHQUFHLEVBQUMsTUFBekI7QUFBZ0MsSUFBQSxJQUFJLEVBQUMsSUFBckM7QUFBMEMsSUFBQSxFQUFFLEVBQUM7QUFBN0MsSUFERixTQURGLGVBTUUsNkJBQUMsZ0JBQUQ7QUFBUSxJQUFBLEVBQUUsRUFBQyxJQUFYO0FBQWdCLElBQUEsSUFBSSxFQUFDLEdBQXJCO0FBQXlCLElBQUEsT0FBTyxFQUFFO0FBQUEsYUFBTUssUUFBUSxDQUFDTCx3QkFBRCxDQUFkO0FBQUE7QUFBbEMsa0JBQ0UsNkJBQUMsY0FBRDtBQUFNLElBQUEsSUFBSSxFQUFDLElBQVg7QUFBZ0IsSUFBQSxFQUFFLEVBQUMsSUFBbkI7QUFBd0IsSUFBQSxNQUFNLEVBQUMsT0FBL0I7QUFBdUMsSUFBQSxHQUFHLEVBQUU7QUFBRWdCLE1BQUFBLFdBQVcsRUFBRTtBQUFmLEtBQTVDO0FBQWtFLElBQUEsR0FBRyxFQUFDO0FBQXRFLElBREYsYUFORixDQURGLGVBWUUsNkJBQUMsZUFBRDtBQUFPLElBQUEsRUFBRSxFQUFDLFVBQVY7QUFBcUIsSUFBQSxJQUFJLEVBQUMsR0FBMUI7QUFBOEIsSUFBQSxVQUFVLEVBQUUsS0FBMUM7QUFBaUQsSUFBQSxRQUFRLE1BQXpEO0FBQTBELElBQUEsS0FBSyxFQUFFaEI7QUFBakUsSUFaRixDQURGO0FBZ0JELENBdEJNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IGRpZmYgfSBmcm9tICdkZWVwLW9iamVjdC1kaWZmJztcbmltcG9ydCB7IFRoZW1lLCBJbnB1dCwgRmxleExheW91dCwgSWNvbiwgQnV0dG9uLCBUZXh0IH0gZnJvbSAnQGRlaXR5L2ZhbGNvbi11aSc7XG5cbmNvbnN0IENSRUFURV9USEVNRV9JTVBPUlQgPSBcImltcG9ydCB7IGNyZWF0ZVRoZW1lIH0gZnJvbSAnQGRlaXR5L2ZhbGNvbi11aSc7XCI7XG5cbmZ1bmN0aW9uIGdldFRoZW1lQ3VzdG9taXphdGlvbnMoaW5pdGlhbFRoZW1lOiBUaGVtZSwgY3VycmVudFRoZW1lOiBUaGVtZSkge1xuICBjb25zdCB0aGVtZURpZmYgPSBkaWZmKGluaXRpYWxUaGVtZSBhcyBvYmplY3QsIGN1cnJlbnRUaGVtZSk7XG5cbiAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoZW1lRGlmZiwgbnVsbCwgMik7XG59XG5cbmZ1bmN0aW9uIHdpdGhFeHBvcnRzKGN1c3RvbWl6YXRpb25zU2VyaWFsaXplZDogc3RyaW5nKSB7XG4gIHJldHVybiBgJHtDUkVBVEVfVEhFTUVfSU1QT1JUfVxcblxcbmV4cG9ydCBjb25zdCB0aGVtZSA9IGNyZWF0ZVRoZW1lKCR7Y3VzdG9taXphdGlvbnNTZXJpYWxpemVkfSk7YDtcbn1cblxudHlwZSBUaGVtZURvd25sb2FkZXJQcm9wcyA9IHtcbiAgY3VycmVudFRoZW1lOiBUaGVtZTtcbiAgaW5pdGlhbFRoZW1lOiBUaGVtZTtcbn07XG5cbmZ1bmN0aW9uIGNvcHlUb0NsaXBib2FyZChzZXJpYWxpemVkQ3VzdG9taXphdGlvbnM6IHN0cmluZykge1xuICAod2luZG93Lm5hdmlnYXRvciBhcyBhbnkpLmNsaXBib2FyZC53cml0ZVRleHQod2l0aEV4cG9ydHMoc2VyaWFsaXplZEN1c3RvbWl6YXRpb25zKSk7XG59XG5cbmZ1bmN0aW9uIGRvd25sb2FkKHNlcmlhbGl6ZWRDdXN0b21pemF0aW9uczogc3RyaW5nKSB7XG4gIGNvbnN0IGN1c3RvbWl6YXRpb25zID0gd2l0aEV4cG9ydHMoc2VyaWFsaXplZEN1c3RvbWl6YXRpb25zKTtcbiAgY29uc3QgZGF0YSA9IGBkYXRhOnRleHQvanNvbjtjaGFyc2V0PXV0Zi04LCR7ZW5jb2RlVVJJQ29tcG9uZW50KGN1c3RvbWl6YXRpb25zKX1gO1xuXG4gIGNvbnN0IGRvd25sb2FkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG5cbiAgZG93bmxvYWRlci5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBkYXRhKTtcbiAgZG93bmxvYWRlci5zZXRBdHRyaWJ1dGUoJ2Rvd25sb2FkJywgJ3RoZW1lLmpzJyk7XG4gIGRvd25sb2FkZXIuY2xpY2soKTtcbn1cblxuZXhwb3J0IGNvbnN0IFRoZW1lRG93bmxvYWRlcjogUmVhY3QuU0ZDPFRoZW1lRG93bmxvYWRlclByb3BzPiA9ICh7IGluaXRpYWxUaGVtZSwgY3VycmVudFRoZW1lIH0pID0+IHtcbiAgY29uc3Qgc2VyaWFsaXplZEN1c3RvbWl6YXRpb25zID0gZ2V0VGhlbWVDdXN0b21pemF0aW9ucyhpbml0aWFsVGhlbWUsIGN1cnJlbnRUaGVtZSk7XG4gIGlmIChzZXJpYWxpemVkQ3VzdG9taXphdGlvbnMgPT09ICd7fScpIHtcbiAgICByZXR1cm4gPFRleHQgZm9udFNpemU9XCJtZFwiPk5vdGhpbmcgdG8gZG93bmxvYWQgeWV0LCB0cnkgbWFraW5nIGZldyBjdXN0b21pemF0aW9ucyBmaXJzdCE8L1RleHQ+O1xuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8RmxleExheW91dCBjc3M9e3sgaGVpZ2h0OiAnMTAwJScgfX0gZmxleERpcmVjdGlvbj1cImNvbHVtblwiPlxuICAgICAgPEZsZXhMYXlvdXQgbWI9XCJzbVwiPlxuICAgICAgICA8QnV0dG9uIG1yPVwieHNcIiBmbGV4PVwiMVwiIG9uQ2xpY2s9eygpID0+IGNvcHlUb0NsaXBib2FyZChzZXJpYWxpemVkQ3VzdG9taXphdGlvbnMpfT5cbiAgICAgICAgICA8SWNvbiBzdHJva2U9XCJ3aGl0ZVwiIHNyYz1cImNvcHlcIiBzaXplPVwibWRcIiBtcj1cInNtXCIgLz5cbiAgICAgICAgICBDb3B5XG4gICAgICAgIDwvQnV0dG9uPlxuXG4gICAgICAgIDxCdXR0b24gbWw9XCJ4c1wiIGZsZXg9XCIxXCIgb25DbGljaz17KCkgPT4gZG93bmxvYWQoc2VyaWFsaXplZEN1c3RvbWl6YXRpb25zKX0+XG4gICAgICAgICAgPEljb24gc2l6ZT1cIm1kXCIgbXI9XCJzbVwiIHN0cm9rZT1cIndoaXRlXCIgY3NzPXt7IHN0cm9rZVdpZHRoOiAnNCcgfX0gc3JjPVwiZG93bmxvYWRcIiAvPlxuICAgICAgICAgIERvd25sb2FkXG4gICAgICAgIDwvQnV0dG9uPlxuICAgICAgPC9GbGV4TGF5b3V0PlxuICAgICAgPElucHV0IGFzPVwidGV4dGFyZWFcIiBmbGV4PVwiMVwiIHNwZWxsQ2hlY2s9e2ZhbHNlfSByZWFkT25seSB2YWx1ZT17c2VyaWFsaXplZEN1c3RvbWl6YXRpb25zfSAvPlxuICAgIDwvRmxleExheW91dD5cbiAgKTtcbn07XG4iXX0=