"use strict";

var _interopRequireDefault = /*#__PURE__*/require("@babel/runtime/helpers/interopRequireDefault");

exports.__esModule = true;
exports.I18nProvider = void 0;

var _assertThisInitialized2 = /*#__PURE__*/_interopRequireDefault( /*#__PURE__*/require("@babel/runtime/helpers/assertThisInitialized"));

var _inheritsLoose2 = /*#__PURE__*/_interopRequireDefault( /*#__PURE__*/require("@babel/runtime/helpers/inheritsLoose"));

var _react = /*#__PURE__*/_interopRequireDefault( /*#__PURE__*/require("react"));

var _context = /*#__PURE__*/require("./context");

var I18nProvider = /*#__PURE__*/function (_React$Component) {
  (0, _inheritsLoose2.default)(I18nProvider, _React$Component);

  function I18nProvider(props) {
    var _this;

    _this = _React$Component.call(this, props) || this;
    _this.state = {
      updatedAt: new Date()
    };
    _this.onI18nChanged = _this.onI18nChanged.bind((0, _assertThisInitialized2.default)(_this));
    return _this;
  }

  var _proto = I18nProvider.prototype;

  _proto.componentDidMount = function componentDidMount() {
    var _this2 = this;

    var i18n = this.props.i18n;

    _context.defaultOptions.rerenderOn.forEach(function (x) {
      return i18n.on(x, _this2.onI18nChanged);
    });
  };

  _proto.componentWillUnmount = function componentWillUnmount() {
    var _this3 = this;

    var i18n = this.props.i18n;

    _context.defaultOptions.rerenderOn.forEach(function (x) {
      return i18n.off(x, _this3.onI18nChanged);
    });
  };

  _proto.onI18nChanged = function onI18nChanged() {
    this.setState({
      updatedAt: new Date()
    });
  };

  _proto.render = function render() {
    var _this$props = this.props,
        i18n = _this$props.i18n,
        children = _this$props.children;
    var updatedAt = this.state.updatedAt;
    (0, _context.setI18n)(i18n);
    return /*#__PURE__*/_react.default.createElement(_context.I18nContext.Provider, {
      value: {
        updatedAt: updatedAt,
        i18n: i18n,
        language: i18n.language,
        t: i18n.t.bind(i18n),
        options: _context.defaultOptions
      }
    }, children);
  };

  return I18nProvider;
}(_react.default.Component);

exports.I18nProvider = I18nProvider;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9JMThuUHJvdmlkZXIudHN4Il0sIm5hbWVzIjpbIkkxOG5Qcm92aWRlciIsInByb3BzIiwic3RhdGUiLCJ1cGRhdGVkQXQiLCJEYXRlIiwib25JMThuQ2hhbmdlZCIsImJpbmQiLCJjb21wb25lbnREaWRNb3VudCIsImkxOG4iLCJkZWZhdWx0T3B0aW9ucyIsInJlcmVuZGVyT24iLCJmb3JFYWNoIiwieCIsIm9uIiwiY29tcG9uZW50V2lsbFVubW91bnQiLCJvZmYiLCJzZXRTdGF0ZSIsInJlbmRlciIsImNoaWxkcmVuIiwibGFuZ3VhZ2UiLCJ0Iiwib3B0aW9ucyIsIlJlYWN0IiwiQ29tcG9uZW50Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBOztBQUVBOztJQVNhQSxZOzs7QUFDWCx3QkFBWUMsS0FBWixFQUFtQjtBQUFBOztBQUNqQix3Q0FBTUEsS0FBTjtBQUVBLFVBQUtDLEtBQUwsR0FBYTtBQUNYQyxNQUFBQSxTQUFTLEVBQUUsSUFBSUMsSUFBSjtBQURBLEtBQWI7QUFJQSxVQUFLQyxhQUFMLEdBQXFCLE1BQUtBLGFBQUwsQ0FBbUJDLElBQW5CLDZDQUFyQjtBQVBpQjtBQVFsQjs7OztTQUVEQyxpQixHQUFBLDZCQUFvQjtBQUFBOztBQUNsQixRQUFRQyxJQUFSLEdBQWlCLEtBQUtQLEtBQXRCLENBQVFPLElBQVI7O0FBRUFDLDRCQUFlQyxVQUFmLENBQTBCQyxPQUExQixDQUFrQyxVQUFBQyxDQUFDO0FBQUEsYUFBSUosSUFBSSxDQUFDSyxFQUFMLENBQVFELENBQVIsRUFBVyxNQUFJLENBQUNQLGFBQWhCLENBQUo7QUFBQSxLQUFuQztBQUNELEc7O1NBRURTLG9CLEdBQUEsZ0NBQXVCO0FBQUE7O0FBQ3JCLFFBQVFOLElBQVIsR0FBaUIsS0FBS1AsS0FBdEIsQ0FBUU8sSUFBUjs7QUFFQUMsNEJBQWVDLFVBQWYsQ0FBMEJDLE9BQTFCLENBQWtDLFVBQUFDLENBQUM7QUFBQSxhQUFJSixJQUFJLENBQUNPLEdBQUwsQ0FBU0gsQ0FBVCxFQUFZLE1BQUksQ0FBQ1AsYUFBakIsQ0FBSjtBQUFBLEtBQW5DO0FBQ0QsRzs7U0FFREEsYSxHQUFBLHlCQUFnQjtBQUNkLFNBQUtXLFFBQUwsQ0FBYztBQUFFYixNQUFBQSxTQUFTLEVBQUUsSUFBSUMsSUFBSjtBQUFiLEtBQWQ7QUFDRCxHOztTQUVEYSxNLEdBQUEsa0JBQVM7QUFDUCxzQkFBMkIsS0FBS2hCLEtBQWhDO0FBQUEsUUFBUU8sSUFBUixlQUFRQSxJQUFSO0FBQUEsUUFBY1UsUUFBZCxlQUFjQSxRQUFkO0FBQ0EsUUFBUWYsU0FBUixHQUFzQixLQUFLRCxLQUEzQixDQUFRQyxTQUFSO0FBRUEsMEJBQVFLLElBQVI7QUFFQSx3QkFDRSw2QkFBQyxvQkFBRCxDQUFhLFFBQWI7QUFDRSxNQUFBLEtBQUssRUFBRTtBQUNMTCxRQUFBQSxTQUFTLEVBQVRBLFNBREs7QUFFTEssUUFBQUEsSUFBSSxFQUFKQSxJQUZLO0FBR0xXLFFBQUFBLFFBQVEsRUFBRVgsSUFBSSxDQUFDVyxRQUhWO0FBSUxDLFFBQUFBLENBQUMsRUFBRVosSUFBSSxDQUFDWSxDQUFMLENBQU9kLElBQVAsQ0FBWUUsSUFBWixDQUpFO0FBS0xhLFFBQUFBLE9BQU8sRUFBRVo7QUFMSjtBQURULE9BU0dTLFFBVEgsQ0FERjtBQWFELEc7OztFQTlDK0JJLGVBQU1DLFMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgaTE4biBhcyBJaTE4biB9IGZyb20gJ2kxOG5leHQnO1xuaW1wb3J0IHsgSTE4bkNvbnRleHQsIHNldEkxOG4sIGRlZmF1bHRPcHRpb25zIH0gZnJvbSAnLi9jb250ZXh0JztcblxuZXhwb3J0IHR5cGUgSTE4blByb3ZpZGVyUHJvcHMgPSBSZWFjdC5Qcm9wczx7fT4gJiB7XG4gIGkxOG46IElpMThuO1xufTtcbnR5cGUgSTE4blByb3ZpZGVyU3RhdGUgPSB7XG4gIHVwZGF0ZWRBdDogRGF0ZTtcbn07XG5cbmV4cG9ydCBjbGFzcyBJMThuUHJvdmlkZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8STE4blByb3ZpZGVyUHJvcHMsIEkxOG5Qcm92aWRlclN0YXRlPiB7XG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuXG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgIH07XG5cbiAgICB0aGlzLm9uSTE4bkNoYW5nZWQgPSB0aGlzLm9uSTE4bkNoYW5nZWQuYmluZCh0aGlzKTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIGNvbnN0IHsgaTE4biB9ID0gdGhpcy5wcm9wcztcblxuICAgIGRlZmF1bHRPcHRpb25zLnJlcmVuZGVyT24uZm9yRWFjaCh4ID0+IGkxOG4ub24oeCwgdGhpcy5vbkkxOG5DaGFuZ2VkKSk7XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICBjb25zdCB7IGkxOG4gfSA9IHRoaXMucHJvcHM7XG5cbiAgICBkZWZhdWx0T3B0aW9ucy5yZXJlbmRlck9uLmZvckVhY2goeCA9PiBpMThuLm9mZih4LCB0aGlzLm9uSTE4bkNoYW5nZWQpKTtcbiAgfVxuXG4gIG9uSTE4bkNoYW5nZWQoKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IHVwZGF0ZWRBdDogbmV3IERhdGUoKSB9KTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IGkxOG4sIGNoaWxkcmVuIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHsgdXBkYXRlZEF0IH0gPSB0aGlzLnN0YXRlO1xuXG4gICAgc2V0STE4bihpMThuKTtcblxuICAgIHJldHVybiAoXG4gICAgICA8STE4bkNvbnRleHQuUHJvdmlkZXJcbiAgICAgICAgdmFsdWU9e3tcbiAgICAgICAgICB1cGRhdGVkQXQsXG4gICAgICAgICAgaTE4bixcbiAgICAgICAgICBsYW5ndWFnZTogaTE4bi5sYW5ndWFnZSxcbiAgICAgICAgICB0OiBpMThuLnQuYmluZChpMThuKSxcbiAgICAgICAgICBvcHRpb25zOiBkZWZhdWx0T3B0aW9uc1xuICAgICAgICB9fVxuICAgICAgPlxuICAgICAgICB7Y2hpbGRyZW59XG4gICAgICA8L0kxOG5Db250ZXh0LlByb3ZpZGVyPlxuICAgICk7XG4gIH1cbn1cbiJdfQ==