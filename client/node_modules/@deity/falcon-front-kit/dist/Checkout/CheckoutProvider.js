"use strict";

var _interopRequireWildcard = /*#__PURE__*/require("@babel/runtime/helpers/interopRequireWildcard");

exports.__esModule = true;
exports.CheckoutProvider = exports.stripTypenames = exports.browseAndCleanObject = exports.isObject = void 0;

var _react = /*#__PURE__*/_interopRequireWildcard( /*#__PURE__*/require("react"));

var _React = /*#__PURE__*/require("../React");

var _CheckoutStep = /*#__PURE__*/require("./CheckoutStep");

var _CheckoutContext = /*#__PURE__*/require("./CheckoutContext");

var _calculateCheckoutStep = /*#__PURE__*/require("./calculateCheckoutStep");

var getNextPossibleCheckoutStepFactory = function getNextPossibleCheckoutStepFactory(stepsOrder) {
  return function (step) {
    var currentStepIndex = stepsOrder.findIndex(function (x) {
      return x === step;
    });
    return currentStepIndex < stepsOrder.length ? stepsOrder[currentStepIndex + 1] : undefined;
  };
};

var isObject = function isObject(value) {
  return Object.prototype.toString.call(value) === '[object Object]';
};

exports.isObject = isObject;

var browseAndCleanObject = function browseAndCleanObject(data, prop) {
  return Object.keys(data).reduce(function (object, key) {
    if (key !== prop) {
      if (isObject(data[key])) {
        object[key] = browseAndCleanObject(data[key], prop);
      } else {
        object[key] = data[key];
      }
    }

    return object;
  }, {});
};
/**
 * Strip `__typename` key from object keys
 * @param initialData
 * @returns {CheckoutValues}
 */


exports.browseAndCleanObject = browseAndCleanObject;

var stripTypenames = function stripTypenames(initialData) {
  return browseAndCleanObject(initialData, '__typename');
};

exports.stripTypenames = stripTypenames;

var CheckoutProvider = function CheckoutProvider(props) {
  var _props$initialValues = props.initialValues,
      initialValues = _props$initialValues === void 0 ? {} : _props$initialValues,
      billingSameAsShipping = props.billingSameAsShipping,
      stepsOrder = props.stepsOrder,
      autoStepForward = props.autoStepForward,
      onValueChanged = props.onValueChanged,
      onStepChanged = props.onStepChanged; // eslint-disable-next-line react-hooks/exhaustive-deps

  var calculateStep = (0, _react.useCallback)(props.calculateStep(stepsOrder), [stepsOrder]);

  var canSetStep = function canSetStep(values, step) {
    return calculateStep(values, step) === step;
  };

  var _useStateCallback = (0, _React.useStateCallback)(calculateStep(initialValues, props.step), function (cStep, pStep) {
    onStepChanged(cStep, pStep, {
      isForwardNavigation: stepsOrder.findIndex(function (x) {
        return x === cStep;
      }) > stepsOrder.findIndex(function (x) {
        return x === pStep;
      })
    });
  }),
      step = _useStateCallback[0],
      setStep = _useStateCallback[1]; // eslint-disable-next-line react-hooks/exhaustive-deps


  var getNextStep = (0, _react.useCallback)(getNextPossibleCheckoutStepFactory(stepsOrder), [stepsOrder]);

  var stepForward = function stepForward() {
    var next = getNextStep(step);
    setStep(next);
    return next;
  };

  var isBoolean = function isBoolean(val) {
    return typeof val === 'boolean';
  };

  var initialState = stripTypenames(initialValues);
  var initialBillingSameAsShipping = false; // First we check the initial state

  if (isBoolean(initialValues.billingSameAsShipping)) {
    initialBillingSameAsShipping = initialValues.billingSameAsShipping;
  } else if (isBoolean(billingSameAsShipping)) {
    initialBillingSameAsShipping = billingSameAsShipping;
  }

  var _useState = (0, _react.useState)(false),
      isLoading = _useState[0],
      setLoading = _useState[1];

  var _useState2 = (0, _react.useState)(initialBillingSameAsShipping),
      isBillingSameAsShipping = _useState2[0],
      setBillingSameAsShipping = _useState2[1];

  var _useState3 = (0, _react.useState)(),
      result = _useState3[0],
      setResult = _useState3[1];

  var _useState4 = (0, _react.useState)(),
      forceStep = _useState4[0],
      setForceStep = _useState4[1];

  var _useStateCallback2 = (0, _React.useStateCallback)(Object.assign({}, initialState), function (newValues) {
    onValueChanged();

    if (autoStepForward) {
      var newStep = forceStep || calculateStep(newValues);
      setStep(newStep);
    }
  }),
      values = _useStateCallback2[0],
      setValues = _useStateCallback2[1];

  (0, _react.useLayoutEffect)(function () {
    if (props.step && props.step !== step) {
      setStep(calculateStep(values, props.step));
    }
  }, [calculateStep, props.step, setStep, step, values, forceStep]);

  var setEmail = function setEmail(email) {
    return setValues(function (x) {
      return Object.assign({}, x, {
        email: email
      });
    });
  };

  var setShippingAddress = function setShippingAddress(shippingAddress) {
    if (!isBillingSameAsShipping) {
      // Force the customer to review their billing address
      setForceStep('billingAddress');
    }

    setValues(function (x) {
      return Object.assign({}, x, {
        shippingAddress: shippingAddress,
        billingAddress: isBillingSameAsShipping ? shippingAddress : x.billingAddress,
        shippingMethod: undefined,
        paymentMethod: undefined
      });
    });
  };

  var setBillingAddress = function setBillingAddress(billingAddress) {
    setForceStep(null);
    setValues(function (x) {
      return Object.assign({}, x, {
        shippingAddress: isBillingSameAsShipping ? billingAddress : x.shippingAddress,
        billingAddress: billingAddress,
        shippingMethod: undefined,
        paymentMethod: undefined
      });
    });
  };

  var setShippingMethod = function setShippingMethod(shippingMethod) {
    return setValues(function (x) {
      return Object.assign({}, x, {
        shippingMethod: shippingMethod,
        paymentMethod: undefined
      });
    });
  };

  var setPaymentMethod = function setPaymentMethod(paymentMethod) {
    return setValues(function (x) {
      return Object.assign({}, x, {
        paymentMethod: paymentMethod
      });
    });
  };
  /**
   * Allows to override OrderData values, useful when order was placed with some overrides and state needs to be synchronized
   * @param order
   */


  var setOrderData = function setOrderData(order) {
    if (order) {
      setValues(Object.assign({}, order));
    }
  };

  return /*#__PURE__*/_react.default.createElement(_CheckoutContext.CheckoutContext.Provider, {
    value: {
      stepsOrder: stepsOrder,
      step: step,
      nextStep: getNextStep(step),
      calculateStep: calculateStep,
      stepForward: stepForward,
      setStep: setStep,
      canSetStep: canSetStep,
      isLoading: isLoading,
      setLoading: setLoading,
      isBillingSameAsShipping: isBillingSameAsShipping,
      setBillingSameAsShipping: setBillingSameAsShipping,
      values: values,
      setEmail: setEmail,
      setShippingAddress: setShippingAddress,
      setBillingAddress: setBillingAddress,
      setShippingMethod: setShippingMethod,
      setPaymentMethod: setPaymentMethod,
      setOrderData: setOrderData,
      result: result,
      setResult: setResult
    }
  }, props.children);
};

exports.CheckoutProvider = CheckoutProvider;
CheckoutProvider.defaultProps = {
  stepsOrder: _CheckoutStep.CheckoutFlow,
  autoStepForward: true,
  billingSameAsShipping: false,
  initialValues: {},
  onValueChanged: function onValueChanged() {},
  onStepChanged: function onStepChanged() {},
  calculateStep: _calculateCheckoutStep.calculateCheckoutStepFactory
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9DaGVja291dC9DaGVja291dFByb3ZpZGVyLnRzeCJdLCJuYW1lcyI6WyJnZXROZXh0UG9zc2libGVDaGVja291dFN0ZXBGYWN0b3J5Iiwic3RlcHNPcmRlciIsInN0ZXAiLCJjdXJyZW50U3RlcEluZGV4IiwiZmluZEluZGV4IiwieCIsImxlbmd0aCIsInVuZGVmaW5lZCIsImlzT2JqZWN0IiwidmFsdWUiLCJPYmplY3QiLCJwcm90b3R5cGUiLCJ0b1N0cmluZyIsImNhbGwiLCJicm93c2VBbmRDbGVhbk9iamVjdCIsImRhdGEiLCJwcm9wIiwia2V5cyIsInJlZHVjZSIsIm9iamVjdCIsImtleSIsInN0cmlwVHlwZW5hbWVzIiwiaW5pdGlhbERhdGEiLCJDaGVja291dFByb3ZpZGVyIiwicHJvcHMiLCJpbml0aWFsVmFsdWVzIiwiYmlsbGluZ1NhbWVBc1NoaXBwaW5nIiwiYXV0b1N0ZXBGb3J3YXJkIiwib25WYWx1ZUNoYW5nZWQiLCJvblN0ZXBDaGFuZ2VkIiwiY2FsY3VsYXRlU3RlcCIsImNhblNldFN0ZXAiLCJ2YWx1ZXMiLCJjU3RlcCIsInBTdGVwIiwiaXNGb3J3YXJkTmF2aWdhdGlvbiIsInNldFN0ZXAiLCJnZXROZXh0U3RlcCIsInN0ZXBGb3J3YXJkIiwibmV4dCIsImlzQm9vbGVhbiIsInZhbCIsImluaXRpYWxTdGF0ZSIsImluaXRpYWxCaWxsaW5nU2FtZUFzU2hpcHBpbmciLCJpc0xvYWRpbmciLCJzZXRMb2FkaW5nIiwiaXNCaWxsaW5nU2FtZUFzU2hpcHBpbmciLCJzZXRCaWxsaW5nU2FtZUFzU2hpcHBpbmciLCJyZXN1bHQiLCJzZXRSZXN1bHQiLCJmb3JjZVN0ZXAiLCJzZXRGb3JjZVN0ZXAiLCJuZXdWYWx1ZXMiLCJuZXdTdGVwIiwic2V0VmFsdWVzIiwic2V0RW1haWwiLCJlbWFpbCIsInNldFNoaXBwaW5nQWRkcmVzcyIsInNoaXBwaW5nQWRkcmVzcyIsImJpbGxpbmdBZGRyZXNzIiwic2hpcHBpbmdNZXRob2QiLCJwYXltZW50TWV0aG9kIiwic2V0QmlsbGluZ0FkZHJlc3MiLCJzZXRTaGlwcGluZ01ldGhvZCIsInNldFBheW1lbnRNZXRob2QiLCJzZXRPcmRlckRhdGEiLCJvcmRlciIsIm5leHRTdGVwIiwiY2hpbGRyZW4iLCJkZWZhdWx0UHJvcHMiLCJDaGVja291dEZsb3ciLCJjYWxjdWxhdGVDaGVja291dFN0ZXBGYWN0b3J5Il0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBRUE7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBV0EsSUFBTUEsa0NBRTBDLEdBQUcsU0FGN0NBLGtDQUU2QyxDQUFBQyxVQUFVO0FBQUEsU0FBSSxVQUFBQyxJQUFJLEVBQUk7QUFDdkUsUUFBTUMsZ0JBQWdCLEdBQUdGLFVBQVUsQ0FBQ0csU0FBWCxDQUFxQixVQUFBQyxDQUFDO0FBQUEsYUFBSUEsQ0FBQyxLQUFLSCxJQUFWO0FBQUEsS0FBdEIsQ0FBekI7QUFFQSxXQUFPQyxnQkFBZ0IsR0FBR0YsVUFBVSxDQUFDSyxNQUE5QixHQUF1Q0wsVUFBVSxDQUFDRSxnQkFBZ0IsR0FBRyxDQUFwQixDQUFqRCxHQUEwRUksU0FBakY7QUFDRCxHQUo0RDtBQUFBLENBRjdEOztBQVFPLElBQU1DLFFBQVEsR0FBRyxTQUFYQSxRQUFXLENBQUNDLEtBQUQsRUFBeUI7QUFDL0MsU0FBT0MsTUFBTSxDQUFDQyxTQUFQLENBQWlCQyxRQUFqQixDQUEwQkMsSUFBMUIsQ0FBK0JKLEtBQS9CLE1BQTBDLGlCQUFqRDtBQUNELENBRk07Ozs7QUFJQSxJQUFNSyxvQkFBb0IsR0FBRyxTQUF2QkEsb0JBQXVCLENBQUNDLElBQUQsRUFBWUMsSUFBWixFQUE2QjtBQUMvRCxTQUFPTixNQUFNLENBQUNPLElBQVAsQ0FBWUYsSUFBWixFQUFrQkcsTUFBbEIsQ0FBeUIsVUFBQ0MsTUFBRCxFQUFTQyxHQUFULEVBQWlCO0FBQy9DLFFBQUlBLEdBQUcsS0FBS0osSUFBWixFQUFrQjtBQUNoQixVQUFJUixRQUFRLENBQUNPLElBQUksQ0FBQ0ssR0FBRCxDQUFMLENB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LEVBQWpCQSxpQkFmSztBQWdCTEMsTUFBQUEsaUJBQWlCLEVBQWpCQSxpQkFoQks7QUFpQkxDLE1BQUFBLGdCQUFnQixFQUFoQkEsZ0JBakJLO0FBa0JMQyxNQUFBQSxZQUFZLEVBQVpBLFlBbEJLO0FBbUJMakIsTUFBQUEsTUFBTSxFQUFOQSxNQW5CSztBQW9CTEMsTUFBQUEsU0FBUyxFQUFUQTtBQXBCSztBQURULEtBd0JHekIsS0FBSyxDQUFDNEMsUUF4QlQsQ0FERjtBQTRCRCxDQTFJTTs7O0FBMklQN0MsZ0JBQWdCLENBQUM4QyxZQUFqQixHQUFnQztBQUM5QnBFLEVBQUFBLFVBQVUsRUFBRXFFLDBCQURrQjtBQUU5QjNDLEVBQUFBLGVBQWUsRUFBRSxJQUZhO0FBRzlCRCxFQUFBQSxxQkFBcUIsRUFBRSxLQUhPO0FBSTlCRCxFQUFBQSxhQUFhLEVBQUUsRUFKZTtBQUs5QkcsRUFBQUEsY0FBYyxFQUFFLDBCQUFNLENBQUUsQ0FMTTtBQU05QkMsRUFBQUEsYUFBYSxFQUFFLHlCQUFNLENBQUUsQ0FOTztBQU85QkMsRUFBQUEsYUFBYSxFQUFFeUM7QUFQZSxDQUFoQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlQ2FsbGJhY2ssIHVzZUxheW91dEVmZmVjdCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IFBsYWNlT3JkZXJSZXN1bHQgfSBmcm9tICdAZGVpdHkvZmFsY29uLXNob3AtZXh0ZW5zaW9uJztcbmltcG9ydCB7IHVzZVN0YXRlQ2FsbGJhY2sgfSBmcm9tICcuLi9SZWFjdCc7XG5pbXBvcnQgeyBDaGVja291dFZhbHVlcywgU2V0Q2hlY2tvdXRWYWx1ZXMgfSBmcm9tICcuL0NoZWNrb3V0VmFsdWVzJztcbmltcG9ydCB7IENoZWNrb3V0U3RlcCwgQ2hlY2tvdXRTdGVwVHlwZSwgQ2hlY2tvdXRGbG93IH0gZnJvbSAnLi9DaGVja291dFN0ZXAnO1xuaW1wb3J0IHsgQ2hlY2tvdXRDb250ZXh0IH0gZnJvbSAnLi9DaGVja291dENvbnRleHQnO1xuaW1wb3J0IHsgY2FsY3VsYXRlQ2hlY2tvdXRTdGVwRmFjdG9yeSwgQ2FsY3VsYXRlQ2hlY2tvdXRTdGVwIH0gZnJvbSAnLi9jYWxjdWxhdGVDaGVja291dFN0ZXAnO1xuXG5leHBvcnQgdHlwZSBPblN0ZXBDaGFuZ2VkPFRDaGVja291dFN0ZXAgZXh0ZW5kcyBzdHJpbmcgPSBDaGVja291dFN0ZXBUeXBlPiA9IChcbiAgY3VycmVudDogVENoZWNrb3V0U3RlcCxcbiAgcHJldmlvdXM6IFRDaGVja291dFN0ZXAgfCB1bmRlZmluZWQsXG4gIHByb3BzOiB7IGlzRm9yd2FyZE5hdmlnYXRpb246IGJvb2xlYW4gfVxuKSA9PiB2b2lkO1xuXG5pbnRlcmZhY2UgSUdldE5leHRQb3NzaWJsZUNoZWNrb3V0U3RlcDxUQ2hlY2tvdXRTdGVwPiB7XG4gIChzdGVwOiBUQ2hlY2tvdXRTdGVwKTogVENoZWNrb3V0U3RlcCB8IHVuZGVmaW5lZDtcbn1cbmNvbnN0IGdldE5leHRQb3NzaWJsZUNoZWNrb3V0U3RlcEZhY3Rvcnk6IDxUQ2hlY2tvdXRTdGVwIGV4dGVuZHMgc3RyaW5nID0gQ2hlY2tvdXRTdGVwVHlwZT4oXG4gIHN0ZXBzT3JkZXI6IFRDaGVja291dFN0ZXBbXVxuKSA9PiBJR2V0TmV4dFBvc3NpYmxlQ2hlY2tvdXRTdGVwPFRDaGVja291dFN0ZXA+ID0gc3RlcHNPcmRlciA9PiBzdGVwID0+IHtcbiAgY29uc3QgY3VycmVudFN0ZXBJbmRleCA9IHN0ZXBzT3JkZXIuZmluZEluZGV4KHggPT4geCA9PT0gc3RlcCk7XG5cbiAgcmV0dXJuIGN1cnJlbnRTdGVwSW5kZXggPCBzdGVwc09yZGVyLmxlbmd0aCA/IHN0ZXBzT3JkZXJbY3VycmVudFN0ZXBJbmRleCArIDFdIDogdW5kZWZpbmVkO1xufTtcblxuZXhwb3J0IGNvbnN0IGlzT2JqZWN0ID0gKHZhbHVlOiBhbnkpOiBib29sZWFuID0+IHtcbiAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT09ICdbb2JqZWN0IE9iamVjdF0nO1xufTtcblxuZXhwb3J0IGNvbnN0IGJyb3dzZUFuZENsZWFuT2JqZWN0ID0gKGRhdGE6IGFueSwgcHJvcDogc3RyaW5nKSA9PiB7XG4gIHJldHVybiBPYmplY3Qua2V5cyhkYXRhKS5yZWR1Y2UoKG9iamVjdCwga2V5KSA9PiB7XG4gICAgaWYgKGtleSAhPT0gcHJvcCkge1xuICAgICAgaWYgKGlzT2JqZWN0KGRhdGFba2V5XSkpIHtcbiAgICAgICAgb2JqZWN0W2tleV0gPSBicm93c2VBbmRDbGVhbk9iamVjdChkYXRhW2tleV0sIHByb3ApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb2JqZWN0W2tleV0gPSBkYXRhW2tleV07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmplY3Q7XG4gIH0sIHt9KTtcbn07XG5cbi8qKlxuICogU3RyaXAgYF9fdHlwZW5hbWVgIGtleSBmcm9tIG9iamVjdCBrZXlzXG4gKiBAcGFyYW0gaW5pdGlhbERhdGFcbiAqIEByZXR1cm5zIHtDaGVja291dFZhbHVlc31cbiAqL1xuZXhwb3J0IGNvbnN0IHN0cmlwVHlwZW5hbWVzID0gKGluaXRpYWxEYXRhOiBDaGVja291dFZhbHVlcyk6IENoZWNrb3V0VmFsdWVzID0+IHtcbiAgcmV0dXJuIGJyb3dzZUFuZENsZWFuT2JqZWN0KGluaXRpYWxEYXRhLCAnX190eXBlbmFtZScpO1xufTtcblxuZXhwb3J0IHR5cGUgQ2hlY2tvdXRQcm92aWRlclByb3BzPFRDaGVja291dFN0ZXAgZXh0ZW5kcyBzdHJpbmcgPSBDaGVja291dFN0ZXBUeXBlPiA9IHtcbiAgaW5pdGlhbFZhbHVlcz86IENoZWNrb3V0VmFsdWVzO1xuICBvblZhbHVlQ2hhbmdlZD86ICgpID0+IHZvaWQ7XG4gIGJpbGxpbmdTYW1lQXNTaGlwcGluZz86IGJvb2xlYW47XG4gIHN0ZXA/OiBUQ2hlY2tvdXRTdGVwO1xuICBzdGVwc09yZGVyPzogVENoZWNrb3V0U3RlcFtdO1xuICBhdXRvU3RlcEZvcndhcmQ/OiBib29sZWFuO1xuICBvblN0ZXBDaGFuZ2VkPzogT25TdGVwQ2hhbmdlZDtcbiAgY2FsY3VsYXRlU3RlcD86IChzdGVwc09yZGVyczogVENoZWNrb3V0U3RlcFtdKSA9PiBDYWxjdWxhdGVDaGVja291dFN0ZXA8VENoZWNrb3V0U3RlcD47XG59O1xuZXhwb3J0IGNvbnN0IENoZWNrb3V0UHJvdmlkZXI6IFJlYWN0LlNGQzxDaGVja291dFByb3ZpZGVyUHJvcHM+ID0gcHJvcHMgPT4ge1xuICBjb25zdCB7XG4gICAgaW5pdGlhbFZhbHVlcyA9IHt9LFxuICAgIGJpbGxpbmdTYW1lQXNTaGlwcGluZyxcbiAgICBzdGVwc09yZGVyLFxuICAgIGF1dG9TdGVwRm9yd2FyZCxcbiAgICBvblZhbHVlQ2hhbmdlZCxcbiAgICBvblN0ZXBDaGFuZ2VkXG4gIH0gPSBwcm9wcztcblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvZXhoYXVzdGl2ZS1kZXBzXG4gIGNvbnN0IGNhbGN1bGF0ZVN0ZXAgPSB1c2VDYWxsYmFjayhwcm9wcy5jYWxjdWxhdGVTdGVwKHN0ZXBzT3JkZXIpLCBbc3RlcHNPcmRlcl0pO1xuICBjb25zdCBjYW5TZXRTdGVwID0gKHZhbHVlcywgc3RlcCkgPT4gY2FsY3VsYXRlU3RlcCh2YWx1ZXMsIHN0ZXApID09PSBzdGVwO1xuICBjb25zdCBbc3RlcCwgc2V0U3RlcF0gPSB1c2VTdGF0ZUNhbGxiYWNrPGtleW9mIHR5cGVvZiBDaGVja291dFN0ZXA+KFxuICAgIGNhbGN1bGF0ZVN0ZXAoaW5pdGlhbFZhbHVlcywgcHJvcHMuc3RlcCksXG4gICAgKGNTdGVwLCBwU3RlcCkgPT4ge1xuICAgICAgb25TdGVwQ2hhbmdlZChjU3RlcCwgcFN0ZXAsIHtcbiAgICAgICAgaXNGb3J3YXJkTmF2aWdhdGlvbjogc3RlcHNPcmRlci5maW5kSW5kZXgoeCA9PiB4ID09PSBjU3RlcCkgPiBzdGVwc09yZGVyLmZpbmRJbmRleCh4ID0+IHggPT09IHBTdGVwKVxuICAgICAgfSk7XG4gICAgfVxuICApO1xuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9leGhhdXN0aXZlLWRlcHNcbiAgY29uc3QgZ2V0TmV4dFN0ZXAgPSB1c2VDYWxsYmFjayhnZXROZXh0UG9zc2libGVDaGVja291dFN0ZXBGYWN0b3J5KHN0ZXBzT3JkZXIpLCBbc3RlcHNPcmRlcl0pO1xuICBjb25zdCBzdGVwRm9yd2FyZCA9ICgpID0+IHtcbiAgICBjb25zdCBuZXh0ID0gZ2V0TmV4dFN0ZXAoc3RlcCk7XG4gICAgc2V0U3RlcChuZXh0KTtcblxuICAgIHJldHVybiBuZXh0O1xuICB9O1xuXG4gIGNvbnN0IGlzQm9vbGVhbiA9IHZhbCA9PiB0eXBlb2YgdmFsID09PSAnYm9vbGVhbic7XG5cbiAgY29uc3QgaW5pdGlhbFN0YXRlID0gc3RyaXBUeXBlbmFtZXMoaW5pdGlhbFZhbHVlcyk7XG5cbiAgbGV0IGluaXRpYWxCaWxsaW5nU2FtZUFzU2hpcHBpbmcgPSBmYWxzZTtcblxuICAvLyBGaXJzdCB3ZSBjaGVjayB0aGUgaW5pdGlhbCBzdGF0ZVxuICBpZiAoaXNCb29sZWFuKGluaXRpYWxWYWx1ZXMuYmlsbGluZ1NhbWVBc1NoaXBwaW5nKSkge1xuICAgIGluaXRpYWxCaWxsaW5nU2FtZUFzU2hpcHBpbmcgPSBpbml0aWFsVmFsdWVzLmJpbGxpbmdTYW1lQXNTaGlwcGluZztcbiAgfSBlbHNlIGlmIChpc0Jvb2xlYW4oYmlsbGluZ1NhbWVBc1NoaXBwaW5nKSkge1xuICAgIGluaXRpYWxCaWxsaW5nU2FtZUFzU2hpcHBpbmcgPSBiaWxsaW5nU2FtZUFzU2hpcHBpbmc7XG4gIH1cblxuICBjb25zdCBbaXNMb2FkaW5nLCBzZXRMb2FkaW5nXSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKTtcbiAgY29uc3QgW2lzQmlsbGluZ1NhbWVBc1NoaXBwaW5nLCBzZXRCaWxsaW5nU2FtZUFzU2hpcHBpbmddID0gdXNlU3RhdGU8Ym9vbGVhbj4oaW5pdGlhbEJpbGxpbmdTYW1lQXNTaGlwcGluZyk7XG5cbiAgY29uc3QgW3Jlc3VsdCwgc2V0UmVzdWx0XSA9IHVzZVN0YXRlPFBsYWNlT3JkZXJSZXN1bHQ+KCk7XG4gIGNvbnN0IFtmb3JjZVN0ZXAsIHNldEZvcmNlU3RlcF0gPSB1c2VTdGF0ZTxDaGVja291dFN0ZXBUeXBlIHwgbnVsbD4oKTtcbiAgY29uc3QgW3ZhbHVlcywgc2V0VmFsdWVzXSA9IHVzZVN0YXRlQ2FsbGJhY2s8Q2hlY2tvdXRWYWx1ZXM+KHsgLi4uaW5pdGlhbFN0YXRlIH0sIG5ld1ZhbHVlcyA9PiB7XG4gICAgb25WYWx1ZUNoYW5nZWQoKTtcbiAgICBpZiAoYXV0b1N0ZXBGb3J3YXJkKSB7XG4gICAgICBjb25zdCBuZXdTdGVwID0gZm9yY2VTdGVwIHx8IGNhbGN1bGF0ZVN0ZXAobmV3VmFsdWVzKTtcbiAgICAgIHNldFN0ZXAobmV3U3RlcCk7XG4gICAgfVxuICB9KTtcblxuICB1c2VMYXlvdXRFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChwcm9wcy5zdGVwICYmIHByb3BzLnN0ZXAgIT09IHN0ZXApIHtcbiAgICAgIHNldFN0ZXAoY2FsY3VsYXRlU3RlcCh2YWx1ZXMsIHByb3BzLnN0ZXApKTtcbiAgICB9XG4gIH0sIFtjYWxjdWxhdGVTdGVwLCBwcm9wcy5zdGVwLCBzZXRTdGVwLCBzdGVwLCB2YWx1ZXMsIGZvcmNlU3RlcF0pO1xuXG4gIGNvbnN0IHNldEVtYWlsOiBTZXRDaGVja291dFZhbHVlc1snc2V0RW1haWwnXSA9IGVtYWlsID0+IHNldFZhbHVlcyh4ID0+ICh7IC4uLngsIGVtYWlsIH0pKTtcblxuICBjb25zdCBzZXRTaGlwcGluZ0FkZHJlc3M6IFNldENoZWNrb3V0VmFsdWVzWydzZXRTaGlwcGluZ0FkZHJlc3MnXSA9IHNoaXBwaW5nQWRkcmVzcyA9PiB7XG4gICAgaWYgKCFpc0JpbGxpbmdTYW1lQXNTaGlwcGluZykge1xuICAgICAgLy8gRm9yY2UgdGhlIGN1c3RvbWVyIHRvIHJldmlldyB0aGVpciBiaWxsaW5nIGFkZHJlc3NcbiAgICAgIHNldEZvcmNlU3RlcCgnYmlsbGluZ0FkZHJlc3MnKTtcbiAgICB9XG4gICAgc2V0VmFsdWVzKHggPT4gKHtcbiAgICAgIC4uLngsXG4gICAgICBzaGlwcGluZ0FkZHJlc3MsXG4gICAgICBiaWxsaW5nQWRkcmVzczogaXNCaWxsaW5nU2FtZUFzU2hpcHBpbmcgPyBzaGlwcGluZ0FkZHJlc3MgOiB4LmJpbGxpbmdBZGRyZXNzLFxuICAgICAgc2hpcHBpbmdNZXRob2Q6IHVuZGVmaW5lZCxcbiAgICAgIHBheW1lbnRNZXRob2Q6IHVuZGVmaW5lZFxuICAgIH0pKTtcbiAgfTtcblxuICBjb25zdCBzZXRCaWxsaW5nQWRkcmVzczogU2V0Q2hlY2tvdXRWYWx1ZXNbJ3NldEJpbGxpbmdBZGRyZXNzJ10gPSBiaWxsaW5nQWRkcmVzcyA9PiB7XG4gICAgc2V0Rm9yY2VTdGVwKG51bGwpO1xuICAgIHNldFZhbHVlcyh4ID0+ICh7XG4gICAgICAuLi54LFxuICAgICAgc2hpcHBpbmdBZGRyZXNzOiBpc0JpbGxpbmdTYW1lQXNTaGlwcGluZyA/IGJpbGxpbmdBZGRyZXNzIDogeC5zaGlwcGluZ0FkZHJlc3MsXG4gICAgICBiaWxsaW5nQWRkcmVzcyxcbiAgICAgIHNoaXBwaW5nTWV0aG9kOiB1bmRlZmluZWQsXG4gICAgICBwYXltZW50TWV0aG9kOiB1bmRlZmluZWRcbiAgICB9KSk7XG4gIH07XG5cbiAgY29uc3Qgc2V0U2hpcHBpbmdNZXRob2Q6IFNldENoZWNrb3V0VmFsdWVzWydzZXRTaGlwcGluZ01ldGhvZCddID0gc2hpcHBpbmdNZXRob2QgPT5cbiAgICBzZXRWYWx1ZXMoeCA9PiAoe1xuICAgICAgLi4ueCxcbiAgICAgIHNoaXBwaW5nTWV0aG9kLFxuICAgICAgcGF5bWVudE1ldGhvZDogdW5kZWZpbmVkXG4gICAgfSkpO1xuXG4gIGNvbnN0IHNldFBheW1lbnRNZXRob2Q6IFNldENoZWNrb3V0VmFsdWVzWydzZXRQYXltZW50TWV0aG9kJ10gPSBwYXltZW50TWV0aG9kID0+XG4gICAgc2V0VmFsdWVzKHggPT4gKHsgLi4ueCwgcGF5bWVudE1ldGhvZCB9KSk7XG5cbiAgLyoqXG4gICAqIEFsbG93cyB0byBvdmVycmlkZSBPcmRlckRhdGEgdmFsdWVzLCB1c2VmdWwgd2hlbiBvcmRlciB3YXMgcGxhY2VkIHdpdGggc29tZSBvdmVycmlkZXMgYW5kIHN0YXRlIG5lZWRzIHRvIGJlIHN5bmNocm9uaXplZFxuICAgKiBAcGFyYW0gb3JkZXJcbiAgICovXG4gIGNvbnN0IHNldE9yZGVyRGF0YTogU2V0Q2hlY2tvdXRWYWx1ZXNbJ3NldE9yZGVyRGF0YSddID0gb3JkZXIgPT4ge1xuICAgIGlmIChvcmRlcikge1xuICAgICAgc2V0VmFsdWVzKHsgLi4ub3JkZXIgfSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPENoZWNrb3V0Q29udGV4dC5Qcm92aWRlclxuICAgICAgdmFsdWU9e3tcbiAgICAgICAgc3RlcHNPcmRlcixcbiAgICAgICAgc3RlcCxcbiAgICAgICAgbmV4dFN0ZXA6IGdldE5leHRTdGVwKHN0ZXApLFxuICAgICAgICBjYWxjdWxhdGVTdGVwLFxuICAgICAgICBzdGVwRm9yd2FyZCxcbiAgICAgICAgc2V0U3RlcCxcbiAgICAgICAgY2FuU2V0U3RlcCxcbiAgICAgICAgaXNMb2FkaW5nLFxuICAgICAgICBzZXRMb2FkaW5nLFxuICAgICAgICBpc0JpbGxpbmdTYW1lQXNTaGlwcGluZyxcbiAgICAgICAgc2V0QmlsbGluZ1NhbWVBc1NoaXBwaW5nLFxuICAgICAgICB2YWx1ZXMsXG4gICAgICAgIHNldEVtYWlsLFxuICAgICAgICBzZXRTaGlwcGluZ0FkZHJlc3MsXG4gICAgICAgIHNldEJpbGxpbmdBZGRyZXNzLFxuICAgICAgICBzZXRTaGlwcGluZ01ldGhvZCxcbiAgICAgICAgc2V0UGF5bWVudE1ldGhvZCxcbiAgICAgICAgc2V0T3JkZXJEYXRhLFxuICAgICAgICByZXN1bHQsXG4gICAgICAgIHNldFJlc3VsdFxuICAgICAgfX1cbiAgICA+XG4gICAgICB7cHJvcHMuY2hpbGRyZW59XG4gICAgPC9DaGVja291dENvbnRleHQuUHJvdmlkZXI+XG4gICk7XG59O1xuQ2hlY2tvdXRQcm92aWRlci5kZWZhdWx0UHJvcHMgPSB7XG4gIHN0ZXBzT3JkZXI6IENoZWNrb3V0RmxvdyxcbiAgYXV0b1N0ZXBGb3J3YXJkOiB0cnVlLFxuICBiaWxsaW5nU2FtZUFzU2hpcHBpbmc6IGZhbHNlLFxuICBpbml0aWFsVmFsdWVzOiB7fSxcbiAgb25WYWx1ZUNoYW5nZWQ6ICgpID0+IHt9LFxuICBvblN0ZXBDaGFuZ2VkOiAoKSA9PiB7fSxcbiAgY2FsY3VsYXRlU3RlcDogY2FsY3VsYXRlQ2hlY2tvdXRTdGVwRmFjdG9yeVxufTtcbiJdfQ==