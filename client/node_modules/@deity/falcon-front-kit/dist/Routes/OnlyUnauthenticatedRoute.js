"use strict";

var _interopRequireDefault = /*#__PURE__*/require("@babel/runtime/helpers/interopRequireDefault");

exports.__esModule = true;
exports.OnlyUnauthenticatedRoute = void 0;

var _extends2 = /*#__PURE__*/_interopRequireDefault( /*#__PURE__*/require("@babel/runtime/helpers/extends"));

var _objectWithoutPropertiesLoose2 = /*#__PURE__*/_interopRequireDefault( /*#__PURE__*/require("@babel/runtime/helpers/objectWithoutPropertiesLoose"));

var _inheritsLoose2 = /*#__PURE__*/_interopRequireDefault( /*#__PURE__*/require("@babel/runtime/helpers/inheritsLoose"));

var _react = /*#__PURE__*/_interopRequireDefault( /*#__PURE__*/require("react"));

var _propTypes = /*#__PURE__*/_interopRequireDefault( /*#__PURE__*/require("prop-types"));

var _reactRouterDom = /*#__PURE__*/require("react-router-dom");

var _falconData = /*#__PURE__*/require("@deity/falcon-data");

var _falconShopData = /*#__PURE__*/require("@deity/falcon-shop-data");

var OnlyUnauthenticatedRoute = /*#__PURE__*/function (_React$Component) {
  (0, _inheritsLoose2.default)(OnlyUnauthenticatedRoute, _React$Component);

  function OnlyUnauthenticatedRoute() {
    return _React$Component.apply(this, arguments) || this;
  }

  var _proto = OnlyUnauthenticatedRoute.prototype;

  _proto.render = function render() {
    var _this$props = this.props,
        component = _this$props.component,
        redirectTo = _this$props.redirectTo,
        rest = (0, _objectWithoutPropertiesLoose2.default)(_this$props, ["component", "redirectTo"]);
    var Component = component;
    return /*#__PURE__*/_react.default.createElement(_reactRouterDom.Route, (0, _extends2.default)({}, rest, {
      render: function render(props) {
        return /*#__PURE__*/_react.default.createElement(_falconShopData.IsAuthenticatedQuery, {
          passLoading: true
        }, function (_ref) {
          var data = _ref.data,
              loading = _ref.loading;

          if (loading) {
            // we can not render anything until we get know if the customer is authenticated or not
            return /*#__PURE__*/_react.default.createElement(_falconData.Loader, null);
          }

          if (data.customer) {
            return /*#__PURE__*/_react.default.createElement(_reactRouterDom.Redirect, {
              to: {
                pathname: redirectTo
              }
            });
          }

          return /*#__PURE__*/_react.default.createElement(Component, props);
        });
      }
    }));
  };

  return OnlyUnauthenticatedRoute;
}(_react.default.Component);

exports.OnlyUnauthenticatedRoute = OnlyUnauthenticatedRoute;
OnlyUnauthenticatedRoute.propTypes = /*#__PURE__*/Object.assign({}, _reactRouterDom.Route.propTypes, {
  redirectTo: _propTypes.default.string
});
OnlyUnauthenticatedRoute.defaultProps = {
  redirectTo: '/'
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9Sb3V0ZXMvT25seVVuYXV0aGVudGljYXRlZFJvdXRlLnRzeCJdLCJuYW1lcyI6WyJPbmx5VW5hdXRoZW50aWNhdGVkUm91dGUiLCJyZW5kZXIiLCJwcm9wcyIsImNvbXBvbmVudCIsInJlZGlyZWN0VG8iLCJyZXN0IiwiQ29tcG9uZW50IiwiZGF0YSIsImxvYWRpbmciLCJjdXN0b21lciIsInBhdGhuYW1lIiwiUmVhY3QiLCJwcm9wVHlwZXMiLCJSb3V0ZSIsIlByb3BUeXBlcyIsInN0cmluZyIsImRlZmF1bHRQcm9wcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztJQU9hQSx3Qjs7Ozs7Ozs7O1NBVVhDLE0sR0FBQSxrQkFBUztBQUNQLHNCQUEyQyxLQUFLQyxLQUFoRDtBQUFBLFFBQVFDLFNBQVIsZUFBUUEsU0FBUjtBQUFBLFFBQW1CQyxVQUFuQixlQUFtQkEsVUFBbkI7QUFBQSxRQUFrQ0MsSUFBbEM7QUFDQSxRQUFNQyxTQUFTLEdBQUdILFNBQWxCO0FBRUEsd0JBQ0UsNkJBQUMscUJBQUQsNkJBQ01FLElBRE47QUFFRSxNQUFBLE1BQU0sRUFBRSxnQkFBQUgsS0FBSztBQUFBLDRCQUNYLDZCQUFDLG9DQUFEO0FBQXNCLFVBQUEsV0FBVztBQUFqQyxXQUNHLGdCQUF1QjtBQUFBLGNBQXBCSyxJQUFvQixRQUFwQkEsSUFBb0I7QUFBQSxjQUFkQyxPQUFjLFFBQWRBLE9BQWM7O0FBQ3RCLGNBQUlBLE9BQUosRUFBYTtBQUNYO0FBQ0EsZ0NBQU8sNkJBQUMsa0JBQUQsT0FBUDtBQUNEOztBQUVELGNBQUlELElBQUksQ0FBQ0UsUUFBVCxFQUFtQjtBQUNqQixnQ0FBTyw2QkFBQyx3QkFBRDtBQUFVLGNBQUEsRUFBRSxFQUFFO0FBQUVDLGdCQUFBQSxRQUFRLEVBQUVOO0FBQVo7QUFBZCxjQUFQO0FBQ0Q7O0FBRUQsOEJBQU8sNkJBQUMsU0FBRCxFQUFlRixLQUFmLENBQVA7QUFDRCxTQVpILENBRFc7QUFBQTtBQUZmLE9BREY7QUFxQkQsRzs7O0VBbkMyQ1MsZUFBTUwsUzs7O0FBQXZDTix3QixDQUNKWSxTLGtDQUNEQyxxQkFBRCxDQUFlRCxTO0FBQ2xCUixFQUFBQSxVQUFVLEVBQUVVLG1CQUFVQzs7QUFIYmYsd0IsQ0FNSmdCLFksR0FBZTtBQUNwQlosRUFBQUEsVUFBVSxFQUFFO0FBRFEsQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHsgUm91dGUsIFJlZGlyZWN0LCBSb3V0ZVByb3BzLCBSb3V0ZUNvbXBvbmVudFByb3BzIH0gZnJvbSAncmVhY3Qtcm91dGVyLWRvbSc7XG5pbXBvcnQgeyBMb2FkZXIgfSBmcm9tICdAZGVpdHkvZmFsY29uLWRhdGEnO1xuaW1wb3J0IHsgSXNBdXRoZW50aWNhdGVkUXVlcnkgfSBmcm9tICdAZGVpdHkvZmFsY29uLXNob3AtZGF0YSc7XG5cbmV4cG9ydCB0eXBlIE9ubHlVbmF1dGhlbnRpY2F0ZWRSb3V0ZVByb3BzID0ge1xuICAvKiogZGVmYXVsdCByZWRpcmVjdGlvbiB1cmwgaXMgYC9gICovXG4gIHJlZGlyZWN0VG86IHN0cmluZztcbn0gJiBSb3V0ZVByb3BzO1xuXG5leHBvcnQgY2xhc3MgT25seVVuYXV0aGVudGljYXRlZFJvdXRlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PE9ubHlVbmF1dGhlbnRpY2F0ZWRSb3V0ZVByb3BzPiB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgLi4uKFJvdXRlIGFzIGFueSkucHJvcFR5cGVzLFxuICAgIHJlZGlyZWN0VG86IFByb3BUeXBlcy5zdHJpbmdcbiAgfTtcblxuICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgIHJlZGlyZWN0VG86ICcvJ1xuICB9O1xuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IGNvbXBvbmVudCwgcmVkaXJlY3RUbywgLi4ucmVzdCB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCBDb21wb25lbnQgPSBjb21wb25lbnQgYXMgUmVhY3QuQ29tcG9uZW50VHlwZTxSb3V0ZUNvbXBvbmVudFByb3BzPGFueT4+IHwgUmVhY3QuQ29tcG9uZW50VHlwZTxhbnk+O1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxSb3V0ZVxuICAgICAgICB7Li4ucmVzdH1cbiAgICAgICAgcmVuZGVyPXtwcm9wcyA9PiAoXG4gICAgICAgICAgPElzQXV0aGVudGljYXRlZFF1ZXJ5IHBhc3NMb2FkaW5nPlxuICAgICAgICAgICAgeyh7IGRhdGEsIGxvYWRpbmcgfSkgPT4ge1xuICAgICAgICAgICAgICBpZiAobG9hZGluZykge1xuICAgICAgICAgICAgICAgIC8vIHdlIGNhbiBub3QgcmVuZGVyIGFueXRoaW5nIHVudGlsIHdlIGdldCBrbm93IGlmIHRoZSBjdXN0b21lciBpcyBhdXRoZW50aWNhdGVkIG9yIG5vdFxuICAgICAgICAgICAgICAgIHJldHVybiA8TG9hZGVyIC8+O1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKGRhdGEuY3VzdG9tZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gPFJlZGlyZWN0IHRvPXt7IHBhdGhuYW1lOiByZWRpcmVjdFRvIH19IC8+O1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIDxDb21wb25lbnQgey4uLnByb3BzfSAvPjtcbiAgICAgICAgICAgIH19XG4gICAgICAgICAgPC9Jc0F1dGhlbnRpY2F0ZWRRdWVyeT5cbiAgICAgICAgKX1cbiAgICAgIC8+XG4gICAgKTtcbiAgfVxufVxuIl19