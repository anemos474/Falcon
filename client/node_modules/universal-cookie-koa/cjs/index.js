"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = universalCookieMiddleware;

var _universalCookie = _interopRequireDefault(require("universal-cookie"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

// @ts-ignore
function universalCookieMiddleware() {
  return function (ctx, next) {
    ctx.request.universalCookies = new _universalCookie["default"](ctx.request.headers.cookie || '');
    ctx.request.universalCookies.addChangeListener(function (change) {
      if (change.value === undefined) {
        ctx.cookies.set(change.name, null);
      } else {
        ctx.cookies.set(change.name, change.value, change.options);
      }
    });
    return next();
  };
}

module.exports = exports.default;