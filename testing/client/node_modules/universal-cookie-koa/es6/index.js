// @ts-ignore
import Cookies from 'universal-cookie';
export default function universalCookieMiddleware() {
    return function (ctx, next) {
        ctx.request.universalCookies = new Cookies(ctx.request.headers.cookie || '');
        ctx.request.universalCookies.addChangeListener((change) => {
            if (change.value === undefined) {
                ctx.cookies.set(change.name, null);
            }
            else {
                ctx.cookies.set(change.name, change.value, change.options);
            }
        });
        return next();
    };
}
