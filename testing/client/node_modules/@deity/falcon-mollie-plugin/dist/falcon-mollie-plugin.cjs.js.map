{"version":3,"file":"falcon-mollie-plugin.cjs.js","sources":["../src/MolliePlugin.ts","../src/withMollie.tsx","../src/MollieCardPlugin.ts"],"sourcesContent":["export const MolliePlugin = props => {\n  const { children, config = {} } = props;\n  const issuers = config.issuers || [];\n\n  const payFn = async (paymentData: Object | undefined) => {\n    // Payment specific data\n    // https://docs.mollie.com/reference/v2/orders-api/create-order#payment-parameters\n    if (paymentData) return paymentData;\n    return {};\n  };\n  return children(payFn, issuers);\n};\n","/**\n * Mollie Docs\n * https://docs.mollie.com/guides/mollie-components/overview#add-the-mollie-components-javascript-library-to-your-checkout\n */\nimport React, { useEffect, useState } from 'react';\nimport { Helmet } from 'react-helmet-async';\n\ndeclare global {\n  interface Window {\n    Mollie: any;\n  }\n}\n\nconst locales = {\n  default: 'en_US',\n  en: 'en_US',\n  nl: 'nl_NL'\n  // TODO: possible remaining values to be mapped: nl_BE fr_FR fr_BE de_DE de_AT de_CH es_ES ca_ES pt_PT it_IT nb_NO sv_SE fi_FI da_DK is_IS hu_HU pl_PL lv_LV lt_LT\n};\n\nexport const withMollie = WrappedComponent => {\n  return props => {\n    const [scriptLoaded, setScriptLoaded] = useState(false);\n    const [mollie, setMollie] = useState(null);\n\n    const errMessage = 'Mollie ProfileID was not returned from the server!';\n    const { locale: appLocale = 'en_US', LoaderComp, ErrorComponent, config } = props;\n    const { profileId, testMode = false } = config;\n\n    useEffect(() => {\n      if (scriptLoaded && profileId) {\n        setMollie(\n          window.Mollie(profileId, {\n            locale: locales[appLocale] || locales.default,\n            testmode: testMode\n          })\n        );\n      }\n    }, [scriptLoaded, appLocale, profileId, testMode]);\n\n    useEffect(() => {\n      return () => {\n        const script = document.querySelector('#mollieScript');\n        if (typeof script !== 'undefined' && script != null) {\n          script.parentNode.removeChild(script);\n\n          delete window.Mollie;\n        }\n      };\n    }, []);\n\n    if (!profileId) {\n      return ErrorComponent ? <ErrorComponent>{errMessage}</ErrorComponent> : <>{errMessage}</>;\n    }\n\n    return (\n      <>\n        <Helmet\n          onChangeClientState={() => {\n            document.querySelector('#mollieScript').addEventListener('load', () => setScriptLoaded(true));\n          }}\n        >\n          <script id=\"mollieScript\" src=\"https://js.mollie.com/v1/mollie.js\" async />\n        </Helmet>\n        {mollie ? <WrappedComponent {...props} config={config} mollie={mollie} /> : LoaderComp && <LoaderComp />}\n      </>\n    );\n  };\n};\n","import { withMollie } from './withMollie';\n\nconst Mollie = props => {\n  const { children, mollie } = props;\n\n  const payFn = async (paymentData: Object | undefined) => {\n    // Credit card token generation\n    if (props.method === 'creditcard') {\n      const { token, error } = await mollie.createToken();\n      if (error) throw error;\n      return {\n        token\n      };\n    }\n    // Payment specific data\n    // https://docs.mollie.com/reference/v2/orders-api/create-order#payment-parameters\n    if (paymentData) return paymentData;\n    return {};\n  };\n  return children(payFn, mollie);\n};\n\nexport const MollieCardPlugin = withMollie(Mollie);\n"],"names":["MolliePlugin","props","children","config","issuers","payFn","paymentData","locales","default","en","nl","withMollie","WrappedComponent","scriptLoaded","setScriptLoaded","useState","mollie","setMollie","errMessage","locale","appLocale","LoaderComp","ErrorComponent","profileId","testMode","useEffect","window","Mollie","testmode","script","document","querySelector","parentNode","removeChild","React","Helmet","addEventListener","method","token","error","createToken","MollieCardPlugin"],"mappings":"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"}