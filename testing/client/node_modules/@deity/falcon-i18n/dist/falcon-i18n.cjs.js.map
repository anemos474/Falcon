{"version":3,"file":"falcon-i18n.cjs.js","sources":["../src/context.tsx","../src/I18nProvider.tsx","../src/I18n.tsx","../src/T.tsx"],"sourcesContent":["import React from 'react';\nimport { TFunction, i18n } from 'i18next';\n\nexport type I18nContextOptions = typeof defaultOptions;\nexport const defaultOptions = {\n  rerenderOn: ['languageChanged', 'loaded', 'added', 'removed']\n};\n\nexport type TranslationFunction = TFunction;\n\nexport type I18nContextValue = {\n  updatedAt: Date;\n  i18n: i18n;\n  t: TranslationFunction;\n  language: string;\n  options: I18nContextOptions;\n};\n\nlet i18nInstance: i18n;\n\nexport function setI18n(instance: i18n) {\n  i18nInstance = instance;\n}\n\nexport function getI18n(): i18n {\n  return i18nInstance;\n}\n\nexport const I18nContext = React.createContext<I18nContextValue>({\n  updatedAt: new Date(),\n  i18n: undefined as any,\n  language: undefined as any,\n  t: x => x,\n  options: defaultOptions\n});\n","import React from 'react';\nimport { i18n as Ii18n } from 'i18next';\nimport { I18nContext, setI18n, defaultOptions } from './context';\n\nexport type I18nProviderProps = React.Props<{}> & {\n  i18n: Ii18n;\n};\ntype I18nProviderState = {\n  updatedAt: Date;\n};\n\nexport class I18nProvider extends React.Component<I18nProviderProps, I18nProviderState> {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      updatedAt: new Date()\n    };\n\n    this.onI18nChanged = this.onI18nChanged.bind(this);\n  }\n\n  componentDidMount() {\n    const { i18n } = this.props;\n\n    defaultOptions.rerenderOn.forEach(x => i18n.on(x, this.onI18nChanged));\n  }\n\n  componentWillUnmount() {\n    const { i18n } = this.props;\n\n    defaultOptions.rerenderOn.forEach(x => i18n.off(x, this.onI18nChanged));\n  }\n\n  onI18nChanged() {\n    this.setState({ updatedAt: new Date() });\n  }\n\n  render() {\n    const { i18n, children } = this.props;\n    const { updatedAt } = this.state;\n\n    setI18n(i18n);\n\n    return (\n      <I18nContext.Provider\n        value={{\n          updatedAt,\n          i18n,\n          language: i18n.language,\n          t: i18n.t.bind(i18n),\n          options: defaultOptions\n        }}\n      >\n        {children}\n      </I18nContext.Provider>\n    );\n  }\n}\n","import React, { useContext } from 'react';\nimport PropTypes from 'prop-types';\nimport { TFunction, i18n } from 'i18next';\nimport { I18nContext } from './context';\n\nexport type I18nProps = {\n  children: (t: TFunction, i18n: i18n) => any;\n};\nexport class I18n extends React.Component<I18nProps> {\n  static propTypes = {\n    children: PropTypes.oneOfType([PropTypes.func]).isRequired\n  };\n\n  render() {\n    const { children } = this.props;\n\n    return <I18nContext.Consumer>{x => children(x.t, x.i18n)}</I18nContext.Consumer>;\n  }\n}\n\nexport const useI18n = () => useContext(I18nContext);\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { TOptions } from 'i18next';\nimport { I18nContext } from './context';\n\nexport type TProps = {\n  id: string;\n} & TOptions;\n\n// eslint-disable-next-line id-length\nexport class T extends React.Component<TProps> {\n  static propTypes = {\n    id: PropTypes.string.isRequired,\n    defaultValue: PropTypes.oneOfType([PropTypes.string]),\n    count: PropTypes.number,\n    // eslint-disable-next-line react/forbid-prop-types\n    context: PropTypes.any, // used for contexts (eg. male\\female)\n    replace: PropTypes.shape({}), // object with vars for interpolation - or put them directly in options\n    lng: PropTypes.string,\n    lngs: PropTypes.arrayOf(PropTypes.string),\n    fallbackLng: PropTypes.oneOfType([PropTypes.string, PropTypes.arrayOf(PropTypes.string)]),\n    ns: PropTypes.oneOfType([PropTypes.string, PropTypes.arrayOf(PropTypes.string)]),\n    keySeparator: PropTypes.string,\n    nsSeparator: PropTypes.string,\n    returnObjects: PropTypes.bool, // accessing an object not a translation string\n    joinArrays: PropTypes.string, // char, eg. '\\n' that arrays will be joined by (can be set globally too)\n    postProcess: PropTypes.oneOfType([PropTypes.string, PropTypes.arrayOf(PropTypes.string)]), // postProcessors to apply see interval plurals as a sample\n    interpolation: PropTypes.shape({})\n  };\n\n  render() {\n    const { id, ...translationOptions } = this.props;\n\n    return <I18nContext.Consumer>{({ t }) => t(id, translationOptions)}</I18nContext.Consumer>;\n  }\n}\n"],"names":["defaultOptions","rerenderOn","i18nInstance","setI18n","instance","getI18n","I18nContext","React","createContext","updatedAt","Date","i18n","undefined","language","t","x","options","I18nProvider","Component","constructor","props","state","onI18nChanged","bind","componentDidMount","forEach","on","componentWillUnmount","off","setState","render","children","I18n","propTypes","PropTypes","oneOfType","func","isRequired","useI18n","useContext","T","id","translationOptions","string","defaultValue","count","number","context","any","replace","shape","lng","lngs","arrayOf","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","bool","joinArrays","postProcess","interpolation"],"mappings":"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"}