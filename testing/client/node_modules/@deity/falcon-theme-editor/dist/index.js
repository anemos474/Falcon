"use strict";

var _interopRequireDefault = /*#__PURE__*/require("@babel/runtime/helpers/interopRequireDefault");

exports.__esModule = true;
var _exportNames = {
  ThemeEditor: true
};
exports.ThemeEditor = void 0;

var _extends2 = /*#__PURE__*/_interopRequireDefault( /*#__PURE__*/require("@babel/runtime/helpers/extends"));

var _inheritsLoose2 = /*#__PURE__*/_interopRequireDefault( /*#__PURE__*/require("@babel/runtime/helpers/inheritsLoose"));

var _react = /*#__PURE__*/_interopRequireDefault( /*#__PURE__*/require("react"));

var _falconUi = /*#__PURE__*/require("@deity/falcon-ui");

var _ComponentsEditor = /*#__PURE__*/require("./ComponentsEditor");

var _ComponentFinder = /*#__PURE__*/require("./ComponentFinder");

var _Tabs = /*#__PURE__*/require("./Tabs");

var _ThemePropsEditor = /*#__PURE__*/require("./ThemePropsEditor");

var _editortheme = /*#__PURE__*/require("./editortheme");

var _ThemeDownloader = /*#__PURE__*/require("./ThemeDownloader");

var _ThemePresets = /*#__PURE__*/require("./ThemePresets");

var _fonts2 = /*#__PURE__*/require("./fonts");

var _ThemeEditorState = /*#__PURE__*/require("./ThemeEditorState");

Object.keys(_ThemeEditorState).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;
  if (key in exports && exports[key] === _ThemeEditorState[key]) return;
  exports[key] = _ThemeEditorState[key];
});

var _thememeta = /*#__PURE__*/require("./thememeta");

Object.keys(_thememeta).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;
  if (key in exports && exports[key] === _thememeta[key]) return;
  exports[key] = _thememeta[key];
});

var ThemeEditor = /*#__PURE__*/function (_React$Component) {
  (0, _inheritsLoose2.default)(ThemeEditor, _React$Component);

  function ThemeEditor() {
    var _this;

    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;

    _this.tabs = function (enableComponent) {
      return [{
        name: 'Theme',
        key: 'theme'
      }, enableComponent ? {
        name: 'Component',
        key: 'component'
      } : undefined, {
        name: 'Presets',
        key: 'presets'
      }, {
        name: 'Download',
        key: 'download'
      }].filter(function (x) {
        return x;
      });
    };

    _this.onChange = function (themeKey, propName, isNumber) {
      return function (e) {
        var _themeKey, _this$props$updateThe;

        _this.props.updateTheme((_this$props$updateThe = {}, _this$props$updateThe[themeKey] = (_themeKey = {}, _themeKey[propName] = isNumber ? +e.target.value : e.target.value, _themeKey), _this$props$updateThe));
      };
    };

    _this.onFontChange = function (fontKind) {
      return function (fontOption) {
        var _fonts;

        _this.props.updateTheme({
          fonts: (_fonts = {}, _fonts[fontKind] = fontOption.value, _fonts)
        });

        if (fontOption.google) {
          _this.loadGoogleFont(fontOption.google);
        }
      };
    };

    _this.onPresetChange = function (preset) {
      return function () {
        requestAnimationFrame(function () {
          _this.props.updateTheme(preset.theme, {
            useInitial: true
          });
        });

        _this.props.setActivePreset(preset.name);

        if (!preset.theme.fonts) {
          return;
        }

        var newFont = preset.theme.fonts.sans;

        var potentiallFontToLoad = _fonts2.fonts.filter(function (font) {
          return font.value === newFont;
        })[0];

        if (potentiallFontToLoad && potentiallFontToLoad.google) {
          _this.loadGoogleFont(potentiallFontToLoad.google);
        }
      };
    };

    _this.onComponentThemeChange = function (themeKey, variantKey) {
      return function (key, value) {
        if (variantKey) {
          var _variantKey, _variants, _components;

          _this.props.updateTheme({
            components: (_components = {}, _components[themeKey] = {
              variants: (_variants = {}, _variants[variantKey] = (_variantKey = {}, _variantKey[key] = value, _variantKey), _variants)
            }, _components)
          });
        } else {
          var _themeKey2, _components2;

          _this.props.updateTheme({
            components: (_components2 = {}, _components2[themeKey] = (_themeKey2 = {}, _themeKey2[key] = value, _themeKey2), _components2)
          });
        }
      };
    };

    return _this;
  }

  var _proto = ThemeEditor.prototype;

  _proto.loadGoogleFont = function loadGoogleFont(font) {
    // require is inline as webfontloader does not work server side
    // https://github.com/typekit/webfontloader/issues/383
    var WebFontLoader = require('webfontloader');

    WebFontLoader.load({
      google: {
        families: [font]
      }
    });
  };

  _proto.render = function render() {
    var _ref;

    var _this$props = this.props,
        visible = _this$props.visible,
        toggleVisibility = _this$props.toggleVisibility,
        toggleFinder = _this$props.toggleFinder,
        setActiveTab = _this$props.setActiveTab,
        activeTab = _this$props.activeTab,
        finderActive = _this$props.finderActive,
        theme = _this$props.theme,
        tabs = _this$props.tabs,
        toggleOpenPanel = _this$props.toggleOpenPanel,
        initialTheme = _this$props.initialTheme,
        side = _this$props.side,
        enableComponentFinder = _this$props.enableComponentFinder;
    return /*#__PURE__*/_react.default.createElement(_falconUi.ThemeProvider, {
      theme: _editortheme.editorTheme,
      withoutRoot: true
    }, /*#__PURE__*/_react.default.createElement(_falconUi.Sidebar, {
      as: _falconUi.Portal,
      visible: visible,
      side: side,
      css: {
        position: 'fixed',
        overflowX: 'inherit'
      },
      boxShadow: "subtle",
      bg: "white"
    }, /*#__PURE__*/_react.default.createElement(_falconUi.FlexLayout, {
      flexDirection: "column",
      flexWrap: "nowrap",
      py: "sm",
      pl: "sm",
      css: {
        width: {
          xs: '75vw',
          sm: 480
        }
      }
    }, /*#__PURE__*/_react.default.createElement(_Tabs.Tabs, {
      items: this.tabs(this.props.enableComponentFinder),
      onChange: setActiveTab,
      active: activeTab
    }), /*#__PURE__*/_react.default.createElement(_falconUi.Divider, {
      my: "sm"
    }), /*#__PURE__*/_react.default.createElement(_falconUi.Box, {
      flex: "1",
      css: function css(props) {
        return {
          overflowY: 'auto',
          paddingRight: 10,
          marginRight: 6,
          '::-webkit-scrollbar': {
            width: 3,
            backgroundColor: props.theme.colors.secondaryLight,
            borderRadius: props.theme.borderRadius.medium
          },
          '::-webkit-scrollbar-thumb': {
            borderRadius: props.theme.borderRadius.medium,
            backgroundColor: props.theme.colors.secondaryDark
          }
        };
      }
    }, activeTab === 'theme' && /*#__PURE__*/_react.default.createElement(_ThemePropsEditor.ThemePropsEditor, {
      openPanels: tabs.theme.openPanels,
      toggleOpenPanel: toggleOpenPanel,
      onChange: this.onChange,
      onFontChange: this.onFontChange,
      theme: theme
    }), activeTab === 'component' && tabs.component.selectedComponents.length > 0 && /*#__PURE__*/_react.default.createElement(_ComponentsEditor.ComponentsEditor, {
      selectedComponents: tabs.component.selectedComponents,
      onComponentThemeChange: this.onComponentThemeChange,
      theme: theme
    }), activeTab === 'component' && tabs.component.selectedComponents.length === 0 && /*#__PURE__*/_react.default.createElement(_falconUi.Box, {
      fontSize: "md"
    }, "There are no components selected currenty, ", /*#__PURE__*/_react.default.createElement("br", null), "use component finder", /*#__PURE__*/_react.default.createElement(_falconUi.Icon, {
      onClick: toggleFinder,
      mx: "sm",
      stroke: finderActive ? 'primary' : 'black',
      src: "finder"
    }), "to select one."), activeTab === 'download' && /*#__PURE__*/_react.default.createElement(_ThemeDownloader.ThemeDownloader, {
      currentTheme: theme,
      initialTheme: initialTheme
    }), activeTab === 'presets' && /*#__PURE__*/_react.default.createElement(_ThemePresets.ThemePresets, {
      activePreset: tabs.presets.active,
      onPresetChange: this.onPresetChange
    }))), /*#__PURE__*/_react.default.createElement(_falconUi.Box, (0, _extends2.default)({
      position: "absolute"
    }, (_ref = {}, _ref[side] = '100%', _ref), {
      top: "calc(50% - 35px)",
      display: "flex",
      bg: "white",
      alignItems: "center",
      justifyContent: "center",
      boxShadow: "subtle",
      flexDirection: "column",
      p: "sm",
      css: side === 'right' ? {
        borderTopLeftRadius: 8,
        borderBottomLeftRadius: 8,
        boxShadow: '-2px 5px 5px rgba(0,0,0,.1)'
      } : {
        borderTopRightRadius: 8,
        borderBottomRightRadius: 8,
        boxShadow: '2px 5px 5px rgba(0,0,0,.1)'
      }
    }), /*#__PURE__*/_react.default.createElement(_falconUi.Box, {
      title: (visible ? 'Close' : 'Open') + " theme editor",
      css: {
        cursor: 'pointer'
      },
      onClick: toggleVisibility
    }, /*#__PURE__*/_react.default.createElement(_falconUi.Icon, {
      src: "theme",
      fill: visible ? 'primary' : 'black',
      stroke: visible ? 'primary' : 'black'
    })), enableComponentFinder && /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_falconUi.Divider, {
      m: "xs",
      css: {
        width: '100%'
      }
    }), /*#__PURE__*/_react.default.createElement(_falconUi.Box, {
      title: "Select a themable component in the page to inspect its theme",
      onClick: toggleFinder
    }, /*#__PURE__*/_react.default.createElement(_falconUi.Icon, {
      stroke: finderActive ? 'primary' : 'black',
      src: "finder"
    }))))), finderActive && /*#__PURE__*/_react.default.createElement(_ComponentFinder.ComponentFinder, {
      onChange: this.props.selectComponents
    }));
  };

  return ThemeEditor;
}(_react.default.Component);

exports.ThemeEditor = ThemeEditor;
ThemeEditor.defaultProps = {
  enableComponentFinder: true,
  side: 'right'
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC50c3giXSwibmFtZXMiOlsiVGhlbWVFZGl0b3IiLCJ0YWJzIiwiZW5hYmxlQ29tcG9uZW50IiwibmFtZSIsImtleSIsInVuZGVmaW5lZCIsImZpbHRlciIsIngiLCJvbkNoYW5nZSIsInRoZW1lS2V5IiwicHJvcE5hbWUiLCJpc051bWJlciIsImUiLCJwcm9wcyIsInVwZGF0ZVRoZW1lIiwidGFyZ2V0IiwidmFsdWUiLCJvbkZvbnRDaGFuZ2UiLCJmb250S2luZCIsImZvbnRPcHRpb24iLCJmb250cyIsImdvb2dsZSIsImxvYWRHb29nbGVGb250Iiwib25QcmVzZXRDaGFuZ2UiLCJwcmVzZXQiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJ0aGVtZSIsInVzZUluaXRpYWwiLCJzZXRBY3RpdmVQcmVzZXQiLCJuZXdGb250Iiwic2FucyIsInBvdGVudGlhbGxGb250VG9Mb2FkIiwiZm9udCIsIm9uQ29tcG9uZW50VGhlbWVDaGFuZ2UiLCJ2YXJpYW50S2V5IiwiY29tcG9uZW50cyIsInZhcmlhbnRzIiwiV2ViRm9udExvYWRlciIsInJlcXVpcmUiLCJsb2FkIiwiZmFtaWxpZXMiLCJyZW5kZXIiLCJ2aXNpYmxlIiwidG9nZ2xlVmlzaWJpbGl0eSIsInRvZ2dsZUZpbmRlciIsInNldEFjdGl2ZVRhYiIsImFjdGl2ZVRhYiIsImZpbmRlckFjdGl2ZSIsInRvZ2dsZU9wZW5QYW5lbCIsImluaXRpYWxUaGVtZSIsInNpZGUiLCJlbmFibGVDb21wb25lbnRGaW5kZXIiLCJlZGl0b3JUaGVtZSIsIlBvcnRhbCIsInBvc2l0aW9uIiwib3ZlcmZsb3dYIiwid2lkdGgiLCJ4cyIsInNtIiwib3ZlcmZsb3dZIiwicGFkZGluZ1JpZ2h0IiwibWFyZ2luUmlnaHQiLCJiYWNrZ3JvdW5kQ29sb3IiLCJjb2xvcnMiLCJzZWNvbmRhcnlMaWdodCIsImJvcmRlclJhZGl1cyIsIm1lZGl1bSIsInNlY29uZGFyeURhcmsiLCJvcGVuUGFuZWxzIiwiY29tcG9uZW50Iiwic2VsZWN0ZWRDb21wb25lbnRzIiwibGVuZ3RoIiwicHJlc2V0cyIsImFjdGl2ZSIsImJvcmRlclRvcExlZnRSYWRpdXMiLCJib3JkZXJCb3R0b21MZWZ0UmFkaXVzIiwiYm94U2hhZG93IiwiYm9yZGVyVG9wUmlnaHRSYWRpdXMiLCJib3JkZXJCb3R0b21SaWdodFJhZGl1cyIsImN1cnNvciIsInNlbGVjdENvbXBvbmVudHMiLCJSZWFjdCIsIkNvbXBvbmVudCIsImRlZmF1bHRQcm9wcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7O0FBQ0E7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztJQU9hQSxXOzs7Ozs7Ozs7Ozs7VUFNWEMsSSxHQUFPLFVBQUNDLGVBQUQsRUFBOEM7QUFDbkQsYUFBTyxDQUNMO0FBQUVDLFFBQUFBLElBQUksRUFBRSxPQUFSO0FBQWlCQyxRQUFBQSxHQUFHLEVBQUU7QUFBdEIsT0FESyxFQUVMRixlQUFlLEdBQUc7QUFBRUMsUUFBQUEsSUFBSSxFQUFFLFdBQVI7QUFBcUJDLFFBQUFBLEdBQUcsRUFBRTtBQUExQixPQUFILEdBQTZDQyxTQUZ2RCxFQUdMO0FBQUVGLFFBQUFBLElBQUksRUFBRSxTQUFSO0FBQW1CQyxRQUFBQSxHQUFHLEVBQUU7QUFBeEIsT0FISyxFQUlMO0FBQUVELFFBQUFBLElBQUksRUFBRSxVQUFSO0FBQW9CQyxRQUFBQSxHQUFHLEVBQUU7QUFBekIsT0FKSyxFQUtMRSxNQUxLLENBS0UsVUFBQUMsQ0FBQztBQUFBLGVBQUlBLENBQUo7QUFBQSxPQUxILENBQVA7QUFNRCxLOztVQUVEQyxRLEdBQVcsVUFBQ0MsUUFBRCxFQUFtQkMsUUFBbkIsRUFBcUNDLFFBQXJDO0FBQUEsYUFBNEQsVUFBQ0MsQ0FBRCxFQUE0QztBQUFBOztBQUNqSCxjQUFLQyxLQUFM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LENBREY7QUE0SEQsRzs7O0VBdE84QkMsZUFBTUMsUzs7O0FBQTFCbEYsVyxDQUNKbUYsWSxHQUFlO0FBQ3BCaEMsRUFBQUEscUJBQXFCLEVBQUUsSUFESDtBQUVwQkQsRUFBQUEsSUFBSSxFQUFFO0FBRmMsQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBUaGVtZVByb3ZpZGVyLCBCb3gsIERpdmlkZXIsIEZsZXhMYXlvdXQsIEljb24sIFNpZGViYXIsIFBvcnRhbCB9IGZyb20gJ0BkZWl0eS9mYWxjb24tdWknO1xuaW1wb3J0IHsgQ29tcG9uZW50c0VkaXRvciB9IGZyb20gJy4vQ29tcG9uZW50c0VkaXRvcic7XG5pbXBvcnQgeyBDb21wb25lbnRGaW5kZXIgfSBmcm9tICcuL0NvbXBvbmVudEZpbmRlcic7XG5pbXBvcnQgeyBUYWJzLCBUYWIgfSBmcm9tICcuL1RhYnMnO1xuaW1wb3J0IHsgVGhlbWVFZGl0b3JTdGF0ZVJlbmRlclByb3AsIFRhYktleXMgfSBmcm9tICcuL1RoZW1lRWRpdG9yU3RhdGUnO1xuaW1wb3J0IHsgVGhlbWVQcm9wc0VkaXRvciB9IGZyb20gJy4vVGhlbWVQcm9wc0VkaXRvcic7XG5pbXBvcnQgeyBlZGl0b3JUaGVtZSB9IGZyb20gJy4vZWRpdG9ydGhlbWUnO1xuaW1wb3J0IHsgVGhlbWVEb3dubG9hZGVyIH0gZnJvbSAnLi9UaGVtZURvd25sb2FkZXInO1xuaW1wb3J0IHsgVGhlbWVQcmVzZXRzLCBUaGVtZVByZXNldCB9IGZyb20gJy4vVGhlbWVQcmVzZXRzJztcbmltcG9ydCB7IGZvbnRzIH0gZnJvbSAnLi9mb250cyc7XG5cbmV4cG9ydCAqIGZyb20gJy4vVGhlbWVFZGl0b3JTdGF0ZSc7XG5leHBvcnQgKiBmcm9tICcuL3RoZW1lbWV0YSc7XG5cbnR5cGUgVGhlbWVFZGl0b3JQcm9wcyA9IFRoZW1lRWRpdG9yU3RhdGVSZW5kZXJQcm9wICYge1xuICBlbmFibGVDb21wb25lbnRGaW5kZXI/OiBib29sZWFuO1xuICBzaWRlPzogJ2xlZnQnIHwgJ3JpZ2h0Jztcbn07XG5cbmV4cG9ydCBjbGFzcyBUaGVtZUVkaXRvciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxUaGVtZUVkaXRvclByb3BzPiB7XG4gIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgZW5hYmxlQ29tcG9uZW50RmluZGVyOiB0cnVlLFxuICAgIHNpZGU6ICdyaWdodCdcbiAgfTtcblxuICB0YWJzID0gKGVuYWJsZUNvbXBvbmVudDogYm9vbGVhbik6IFRhYjxUYWJLZXlzPltdID0+IHtcbiAgICByZXR1cm4gW1xuICAgICAgeyBuYW1lOiAnVGhlbWUnLCBrZXk6ICd0aGVtZScgfSxcbiAgICAgIGVuYWJsZUNvbXBvbmVudCA/IHsgbmFtZTogJ0NvbXBvbmVudCcsIGtleTogJ2NvbXBvbmVudCcgfSA6IHVuZGVmaW5lZCxcbiAgICAgIHsgbmFtZTogJ1ByZXNldHMnLCBrZXk6ICdwcmVzZXRzJyB9LFxuICAgICAgeyBuYW1lOiAnRG93bmxvYWQnLCBrZXk6ICdkb3dubG9hZCcgfVxuICAgIF0uZmlsdGVyKHggPT4geCkgYXMgVGFiPFRhYktleXM+W107XG4gIH07XG5cbiAgb25DaGFuZ2UgPSAodGhlbWVLZXk6IHN0cmluZywgcHJvcE5hbWU6IHN0cmluZywgaXNOdW1iZXI/OiBib29sZWFuKSA9PiAoZTogUmVhY3QuQ2hhbmdlRXZlbnQ8SFRNTElucHV0RWxlbWVudD4pID0+IHtcbiAgICB0aGlzLnByb3BzLnVwZGF0ZVRoZW1lKHtcbiAgICAgIFt0aGVtZUtleV06IHtcbiAgICAgICAgW3Byb3BOYW1lXTogaXNOdW1iZXIgPyArZS50YXJnZXQudmFsdWUgOiBlLnRhcmdldC52YWx1ZVxuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIG9uRm9udENoYW5nZSA9IChmb250S2luZDogc3RyaW5nKSA9PiAoZm9udE9wdGlvbjogYW55KSA9PiB7XG4gICAgdGhpcy5wcm9wcy51cGRhdGVUaGVtZSh7XG4gICAgICBmb250czoge1xuICAgICAgICBbZm9udEtpbmRdOiBmb250T3B0aW9uLnZhbHVlXG4gICAgICB9IGFzIGFueVxuICAgIH0pO1xuXG4gICAgaWYgKGZvbnRPcHRpb24uZ29vZ2xlKSB7XG4gICAgICB0aGlzLmxvYWRHb29nbGVGb250KGZvbnRPcHRpb24uZ29vZ2xlKTtcbiAgICB9XG4gIH07XG5cbiAgb25QcmVzZXRDaGFuZ2UgPSAocHJlc2V0OiBUaGVtZVByZXNldCkgPT4gKCkgPT4ge1xuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICB0aGlzLnByb3BzLnVwZGF0ZVRoZW1lKHByZXNldC50aGVtZSwgeyB1c2VJbml0aWFsOiB0cnVlIH0pO1xuICAgIH0pO1xuXG4gICAgdGhpcy5wcm9wcy5zZXRBY3RpdmVQcmVzZXQocHJlc2V0Lm5hbWUpO1xuXG4gICAgaWYgKCFwcmVzZXQudGhlbWUuZm9udHMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgbmV3Rm9udCA9IHByZXNldC50aGVtZS5mb250cy5zYW5zO1xuXG4gICAgY29uc3QgcG90ZW50aWFsbEZvbnRUb0xvYWQgPSBmb250cy5maWx0ZXIoZm9udCA9PiBmb250LnZhbHVlID09PSBuZXdGb250KVswXTtcblxuICAgIGlmIChwb3RlbnRpYWxsRm9udFRvTG9hZCAmJiBwb3RlbnRpYWxsRm9udFRvTG9hZC5nb29nbGUpIHtcbiAgICAgIHRoaXMubG9hZEdvb2dsZUZvbnQocG90ZW50aWFsbEZvbnRUb0xvYWQuZ29vZ2xlKTtcbiAgICB9XG4gIH07XG5cbiAgb25Db21wb25lbnRUaGVtZUNoYW5nZSA9ICh0aGVtZUtleTogc3RyaW5nLCB2YXJpYW50S2V5Pzogc3RyaW5nKSA9PiAoa2V5OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcgfCBvYmplY3QpID0+IHtcbiAgICBpZiAodmFyaWFudEtleSkge1xuICAgICAgdGhpcy5wcm9wcy51cGRhdGVUaGVtZSh7XG4gICAgICAgIGNvbXBvbmVudHM6IHtcbiAgICAgICAgICBbdGhlbWVLZXldOiB7XG4gICAgICAgICAgICB2YXJpYW50czoge1xuICAgICAgICAgICAgICBbdmFyaWFudEtleV06IHtcbiAgICAgICAgICAgICAgICBba2V5XTogdmFsdWVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucHJvcHMudXBkYXRlVGhlbWUoe1xuICAgICAgICBjb21wb25lbnRzOiB7XG4gICAgICAgICAgW3RoZW1lS2V5XToge1xuICAgICAgICAgICAgW2tleV06IHZhbHVlXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgbG9hZEdvb2dsZUZvbnQoZm9udDogc3RyaW5nKSB7XG4gICAgLy8gcmVxdWlyZSBpcyBpbmxpbmUgYXMgd2ViZm9udGxvYWRlciBkb2VzIG5vdCB3b3JrIHNlcnZlciBzaWRlXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL3R5cGVraXQvd2ViZm9udGxvYWRlci9pc3N1ZXMvMzgzXG4gICAgY29uc3QgV2ViRm9udExvYWRlciA9IHJlcXVpcmUoJ3dlYmZvbnRsb2FkZXInKTtcblxuICAgIFdlYkZvbnRMb2FkZXIubG9hZCh7XG4gICAgICBnb29nbGU6IHtcbiAgICAgICAgZmFtaWxpZXM6IFtmb250XVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtcbiAgICAgIHZpc2libGUsXG4gICAgICB0b2dnbGVWaXNpYmlsaXR5LFxuICAgICAgdG9nZ2xlRmluZGVyLFxuICAgICAgc2V0QWN0aXZlVGFiLFxuICAgICAgYWN0aXZlVGFiLFxuICAgICAgZmluZGVyQWN0aXZlLFxuICAgICAgdGhlbWUsXG4gICAgICB0YWJzLFxuICAgICAgdG9nZ2xlT3BlblBhbmVsLFxuICAgICAgaW5pdGlhbFRoZW1lLFxuICAgICAgc2lkZSxcbiAgICAgIGVuYWJsZUNvbXBvbmVudEZpbmRlclxuICAgIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxUaGVtZVByb3ZpZGVyIHRoZW1lPXtlZGl0b3JUaGVtZX0gd2l0aG91dFJvb3Q+XG4gICAgICAgIDxTaWRlYmFyXG4gICAgICAgICAgYXM9e1BvcnRhbH1cbiAgICAgICAgICB2aXNpYmxlPXt2aXNpYmxlfVxuICAgICAgICAgIHNpZGU9e3NpZGV9XG4gICAgICAgICAgY3NzPXt7IHBvc2l0aW9uOiAnZml4ZWQnLCBvdmVyZmxvd1g6ICdpbmhlcml0JyB9fVxuICAgICAgICAgIGJveFNoYWRvdz1cInN1YnRsZVwiXG4gICAgICAgICAgYmc9XCJ3aGl0ZVwiXG4gICAgICAgID5cbiAgICAgICAgICA8RmxleExheW91dFxuICAgICAgICAgICAgZmxleERpcmVjdGlvbj1cImNvbHVtblwiXG4gICAgICAgICAgICBmbGV4V3JhcD1cIm5vd3JhcFwiXG4gICAgICAgICAgICBweT1cInNtXCJcbiAgICAgICAgICAgIHBsPVwic21cIlxuICAgICAgICAgICAgY3NzPXt7XG4gICAgICAgICAgICAgIHdpZHRoOiB7XG4gICAgICAgICAgICAgICAgeHM6ICc3NXZ3JyxcbiAgICAgICAgICAgICAgICBzbTogNDgwXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH19XG4gICAgICAgICAgPlxuICAgICAgICAgICAgPFRhYnMgaXRlbXM9e3RoaXMudGFicyh0aGlzLnByb3BzLmVuYWJsZUNvbXBvbmVudEZpbmRlcil9IG9uQ2hhbmdlPXtzZXRBY3RpdmVUYWJ9IGFjdGl2ZT17YWN0aXZlVGFifSAvPlxuXG4gICAgICAgICAgICA8RGl2aWRlciBteT1cInNtXCIgLz5cblxuICAgICAgICAgICAgPEJveFxuICAgICAgICAgICAgICBmbGV4PVwiMVwiXG4gICAgICAgICAgICAgIGNzcz17cHJvcHMgPT4gKHtcbiAgICAgICAgICAgICAgICBvdmVyZmxvd1k6ICdhdXRvJyxcbiAgICAgICAgICAgICAgICBwYWRkaW5nUmlnaHQ6IDEwLFxuICAgICAgICAgICAgICAgIG1hcmdpblJpZ2h0OiA2LFxuICAgICAgICAgICAgICAgICc6Oi13ZWJraXQtc2Nyb2xsYmFyJzoge1xuICAgICAgICAgICAgICAgICAgd2lkdGg6IDMsXG4gICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IHByb3BzLnRoZW1lLmNvbG9ycy5zZWNvbmRhcnlMaWdodCxcbiAgICAgICAgICAgICAgICAgIGJvcmRlclJhZGl1czogcHJvcHMudGhlbWUuYm9yZGVyUmFkaXVzLm1lZGl1bVxuICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAnOjotd2Via2l0LXNjcm9sbGJhci10aHVtYic6IHtcbiAgICAgICAgICAgICAgICAgIGJvcmRlclJhZGl1czogcHJvcHMudGhlbWUuYm9yZGVyUmFkaXVzLm1lZGl1bSxcbiAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogcHJvcHMudGhlbWUuY29sb3JzLnNlY29uZGFyeURhcmtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7YWN0aXZlVGFiID09PSAndGhlbWUnICYmIChcbiAgICAgICAgICAgICAgICA8VGhlbWVQcm9wc0VkaXRvclxuICAgICAgICAgICAgICAgICAgb3BlblBhbmVscz17dGFicy50aGVtZS5vcGVuUGFuZWxzfVxuICAgICAgICAgICAgICAgICAgdG9nZ2xlT3BlblBhbmVsPXt0b2dnbGVPcGVuUGFuZWx9XG4gICAgICAgICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5vbkNoYW5nZX1cbiAgICAgICAgICAgICAgICAgIG9uRm9udENoYW5nZT17dGhpcy5vbkZvbnRDaGFuZ2V9XG4gICAgICAgICAgICAgICAgICB0aGVtZT17dGhlbWV9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgICB7YWN0aXZlVGFiID09PSAnY29tcG9uZW50JyAmJiB0YWJzLmNvbXBvbmVudC5zZWxlY3RlZENvbXBvbmVudHMubGVuZ3RoID4gMCAmJiAoXG4gICAgICAgICAgICAgICAgPENvbXBvbmVudHNFZGl0b3JcbiAgICAgICAgICAgICAgICAgIHNlbGVjdGVkQ29tcG9uZW50cz17dGFicy5jb21wb25lbnQuc2VsZWN0ZWRDb21wb25lbnRzfVxuICAgICAgICAgICAgICAgICAgb25Db21wb25lbnRUaGVtZUNoYW5nZT17dGhpcy5vbkNvbXBvbmVudFRoZW1lQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgdGhlbWU9e3RoZW1lfVxuICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICl9XG5cbiAgICAgICAgICAgICAge2FjdGl2ZVRhYiA9PT0gJ2NvbXBvbmVudCcgJiYgdGFicy5jb21wb25lbnQuc2VsZWN0ZWRDb21wb25lbnRzLmxlbmd0aCA9PT0gMCAmJiAoXG4gICAgICAgICAgICAgICAgPEJveCBmb250U2l6ZT1cIm1kXCI+XG4gICAgICAgICAgICAgICAgICBUaGVyZSBhcmUgbm8gY29tcG9uZW50cyBzZWxlY3RlZCBjdXJyZW50eSwgPGJyIC8+XG4gICAgICAgICAgICAgICAgICB1c2UgY29tcG9uZW50IGZpbmRlclxuICAgICAgICAgICAgICAgICAgPEljb24gb25DbGljaz17dG9nZ2xlRmluZGVyfSBteD1cInNtXCIgc3Ryb2tlPXtmaW5kZXJBY3RpdmUgPyAncHJpbWFyeScgOiAnYmxhY2snfSBzcmM9XCJmaW5kZXJcIiAvPlxuICAgICAgICAgICAgICAgICAgdG8gc2VsZWN0IG9uZS5cbiAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgICB7YWN0aXZlVGFiID09PSAnZG93bmxvYWQnICYmIDxUaGVtZURvd25sb2FkZXIgY3VycmVudFRoZW1lPXt0aGVtZX0gaW5pdGlhbFRoZW1lPXtpbml0aWFsVGhlbWV9IC8+fVxuXG4gICAgICAgICAgICAgIHthY3RpdmVUYWIgPT09ICdwcmVzZXRzJyAmJiAoXG4gICAgICAgICAgICAgICAgPFRoZW1lUHJlc2V0cyBhY3RpdmVQcmVzZXQ9e3RhYnMucHJlc2V0cy5hY3RpdmV9IG9uUHJlc2V0Q2hhbmdlPXt0aGlzLm9uUHJlc2V0Q2hhbmdlfSAvPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgPC9Cb3g+XG4gICAgICAgICAgPC9GbGV4TGF5b3V0PlxuXG4gICAgICAgICAgPEJveFxuICAgICAgICAgICAgcG9zaXRpb249XCJhYnNvbHV0ZVwiXG4gICAgICAgICAgICB7Li4ueyBbc2lkZV06ICcxMDAlJyB9fVxuICAgICAgICAgICAgdG9wPVwiY2FsYyg1MCUgLSAzNXB4KVwiXG4gICAgICAgICAgICBkaXNwbGF5PVwiZmxleFwiXG4gICAgICAgICAgICBiZz1cIndoaXRlXCJcbiAgICAgICAgICAgIGFsaWduSXRlbXM9XCJjZW50ZXJcIlxuICAgICAgICAgICAganVzdGlmeUNvbnRlbnQ9XCJjZW50ZXJcIlxuICAgICAgICAgICAgYm94U2hhZG93PVwic3VidGxlXCJcbiAgICAgICAgICAgIGZsZXhEaXJlY3Rpb249XCJjb2x1bW5cIlxuICAgICAgICAgICAgcD1cInNtXCJcbiAgICAgICAgICAgIGNzcz17XG4gICAgICAgICAgICAgIHNpZGUgPT09ICdyaWdodCdcbiAgICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyVG9wTGVmdFJhZGl1czogOCxcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyQm90dG9tTGVmdFJhZGl1czogOCxcbiAgICAgICAgICAgICAgICAgICAgYm94U2hhZG93OiAnLTJweCA1cHggNXB4IHJnYmEoMCwwLDAsLjEpJ1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIDoge1xuICAgICAgICAgICAgICAgICAgICBib3JkZXJUb3BSaWdodFJhZGl1czogOCxcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyQm90dG9tUmlnaHRSYWRpdXM6IDgsXG4gICAgICAgICAgICAgICAgICAgIGJveFNoYWRvdzogJzJweCA1cHggNXB4IHJnYmEoMCwwLDAsLjEpJ1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxCb3hcbiAgICAgICAgICAgICAgdGl0bGU9e2Ake3Zpc2libGUgPyAnQ2xvc2UnIDogJ09wZW4nfSB0aGVtZSBlZGl0b3JgfVxuICAgICAgICAgICAgICBjc3M9e3sgY3Vyc29yOiAncG9pbnRlcicgfX1cbiAgICAgICAgICAgICAgb25DbGljaz17dG9nZ2xlVmlzaWJpbGl0eX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPEljb24gc3JjPVwidGhlbWVcIiBmaWxsPXt2aXNpYmxlID8gJ3ByaW1hcnknIDogJ2JsYWNrJ30gc3Ryb2tlPXt2aXNpYmxlID8gJ3ByaW1hcnknIDogJ2JsYWNrJ30gLz5cbiAgICAgICAgICAgIDwvQm94PlxuICAgICAgICAgICAge2VuYWJsZUNvbXBvbmVudEZpbmRlciAmJiAoXG4gICAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAgPERpdmlkZXIgbT1cInhzXCIgY3NzPXt7IHdpZHRoOiAnMTAwJScgfX0gLz5cbiAgICAgICAgICAgICAgICA8Qm94IHRpdGxlPVwiU2VsZWN0IGEgdGhlbWFibGUgY29tcG9uZW50IGluIHRoZSBwYWdlIHRvIGluc3BlY3QgaXRzIHRoZW1lXCIgb25DbGljaz17dG9nZ2xlRmluZGVyfT5cbiAgICAgICAgICAgICAgICAgIDxJY29uIHN0cm9rZT17ZmluZGVyQWN0aXZlID8gJ3ByaW1hcnknIDogJ2JsYWNrJ30gc3JjPVwiZmluZGVyXCIgLz5cbiAgICAgICAgICAgICAgICA8L0JveD5cbiAgICAgICAgICAgICAgPC8+XG4gICAgICAgICAgICApfVxuICAgICAgICAgIDwvQm94PlxuICAgICAgICA8L1NpZGViYXI+XG4gICAgICAgIHtmaW5kZXJBY3RpdmUgJiYgPENvbXBvbmVudEZpbmRlciBvbkNoYW5nZT17dGhpcy5wcm9wcy5zZWxlY3RDb21wb25lbnRzfSAvPn1cbiAgICAgIDwvVGhlbWVQcm92aWRlcj5cbiAgICApO1xuICB9XG59XG4iXX0=