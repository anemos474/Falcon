"use strict";

var _interopRequireDefault = /*#__PURE__*/require("@babel/runtime/helpers/interopRequireDefault");

exports.__esModule = true;
exports.ThemePropsEditor = void 0;

var _react = /*#__PURE__*/_interopRequireDefault( /*#__PURE__*/require("react"));

var _falconUi = /*#__PURE__*/require("@deity/falcon-ui");

var _thememeta = /*#__PURE__*/require("./thememeta");

var _fonts = /*#__PURE__*/require("./fonts");

var EditorSection = function EditorSection(_ref) {
  var theme = _ref.theme,
      section = _ref.section,
      onChange = _ref.onChange,
      onFontChange = _ref.onFontChange;
  return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, Object.keys(theme[section]).map(function (themeProp) {
    var meta = _thememeta.themeMeta[section];
    if (!meta) return null;
    return /*#__PURE__*/_react.default.createElement(_falconUi.GridLayout, {
      alignItems: "center",
      gridGap: "xs",
      mb: "xs",
      gridTemplateColumns: meta.input.type === 'dropdown' ? '50px auto 1.8fr 20px' : '1.1fr auto 1.8fr 35px',
      key: themeProp
    }, /*#__PURE__*/_react.default.createElement(_falconUi.Text, {
      p: "xs"
    }, "\"" + themeProp + "\""), meta.input.type === 'number' && /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_falconUi.NumberInput, {
      value: theme[section][themeProp],
      min: meta.input.min,
      max: meta.input.max,
      step: meta.input.step,
      onChange: onChange(section, themeProp, true)
    }), /*#__PURE__*/_react.default.createElement(_falconUi.RangeInput, {
      value: theme[section][themeProp],
      min: meta.input.min,
      max: meta.input.max,
      step: meta.input.step,
      onChange: onChange(section, themeProp, true)
    }), /*#__PURE__*/_react.default.createElement(_falconUi.Text, {
      p: "none",
      ml: "xs",
      fontSize: "sm"
    }, "px")), meta.input.type === 'dropdown' && /*#__PURE__*/_react.default.createElement(_falconUi.Dropdown, {
      onChange: onFontChange(themeProp),
      gridColumn: "span 3"
    }, /*#__PURE__*/_react.default.createElement(_falconUi.DropdownLabel, null, theme[section][themeProp]), /*#__PURE__*/_react.default.createElement(_falconUi.DropdownMenu, null, _fonts.fonts.map(function (font) {
      return /*#__PURE__*/_react.default.createElement(_falconUi.DropdownMenuItem, {
        key: font.value,
        value: font
      }, font.value + " " + (font.google ? ' - (Google Font)' : ''));
    }))), meta.input.type === 'color' && /*#__PURE__*/_react.default.createElement(_falconUi.Input, {
      onChange: onChange(section, themeProp),
      type: "color",
      gridColumn: "span 2",
      value: theme[section][themeProp],
      css: {
        padding: 0,
        width: 60,
        borderRadius: 0,
        border: 'none'
      }
    }), meta.input.type === 'text' && /*#__PURE__*/_react.default.createElement(_falconUi.Input, {
      onChange: onChange(section, themeProp),
      gridColumn: "span 3",
      type: "text",
      value: theme[section][themeProp]
    }));
  }));
};

var ThemePropsEditor = function ThemePropsEditor(_ref2) {
  var openPanels = _ref2.openPanels,
      toggleOpenPanel = _ref2.toggleOpenPanel,
      theme = _ref2.theme,
      onChange = _ref2.onChange,
      onFontChange = _ref2.onFontChange;
  return /*#__PURE__*/_react.default.createElement(_falconUi.GridLayout, {
    gridGap: "xs"
  }, Object.keys(_thememeta.themeCategories).map(function (categoryKey) {
    var category = _thememeta.themeCategories[categoryKey];
    return /*#__PURE__*/_react.default.createElement(_falconUi.Details, {
      key: category.name,
      open: openPanels[categoryKey]
    }, /*#__PURE__*/_react.default.createElement(_falconUi.Summary, {
      onClick: function onClick(e) {
        e.preventDefault();
        toggleOpenPanel(categoryKey);
      }
    }, category.name), openPanels[categoryKey] && /*#__PURE__*/_react.default.createElement(_falconUi.DetailsContent, {
      pr: "xs"
    }, category.themeSections.length === 1 && /*#__PURE__*/_react.default.createElement(EditorSection, {
      section: category.themeSections[0],
      theme: theme,
      onChange: onChange,
      onFontChange: onFontChange
    }), category.themeSections.length > 1 && category.themeSections.map(function (section) {
      var key = categoryKey + section;
      return /*#__PURE__*/_react.default.createElement(_falconUi.Details, {
        mb: "sm",
        key: key,
        open: openPanels[key]
      }, /*#__PURE__*/_react.default.createElement(_falconUi.Summary, {
        onClick: function onClick(e) {
          e.preventDefault();
          toggleOpenPanel(key);
        }
      }, section), /*#__PURE__*/_react.default.createElement(_falconUi.DetailsContent, {
        mr: "xs"
      }, /*#__PURE__*/_react.default.createElement(EditorSection, {
        section: section,
        theme: theme,
        onChange: onChange,
        onFontChange: onFontChange
      })));
    })));
  }));
};

exports.ThemePropsEditor = ThemePropsEditor;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9UaGVtZVByb3BzRWRpdG9yLnRzeCJdLCJuYW1lcyI6WyJFZGl0b3JTZWN0aW9uIiwidGhlbWUiLCJzZWN0aW9uIiwib25DaGFuZ2UiLCJvbkZvbnRDaGFuZ2UiLCJPYmplY3QiLCJrZXlzIiwibWFwIiwidGhlbWVQcm9wIiwibWV0YSIsInRoZW1lTWV0YSIsImlucHV0IiwidHlwZSIsIm1pbiIsIm1heCIsInN0ZXAiLCJmb250cyIsImZvbnQiLCJ2YWx1ZSIsImdvb2dsZSIsInBhZGRpbmciLCJ3aWR0aCIsImJvcmRlclJhZGl1cyIsImJvcmRlciIsIlRoZW1lUHJvcHNFZGl0b3IiLCJvcGVuUGFuZWxzIiwidG9nZ2xlT3BlblBhbmVsIiwidGhlbWVDYXRlZ29yaWVzIiwiY2F0ZWdvcnlLZXkiLCJjYXRlZ29yeSIsIm5hbWUiLCJlIiwicHJldmVudERlZmF1bHQiLCJ0aGVtZVNlY3Rpb25zIiwibGVuZ3RoIiwia2V5Il0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBZUE7O0FBQ0E7O0FBMkJBLElBQU1BLGFBQTRDLEdBQUcsU0FBL0NBLGFBQStDO0FBQUEsTUFBR0MsS0FBSCxRQUFHQSxLQUFIO0FBQUEsTUFBVUMsT0FBVixRQUFVQSxPQUFWO0FBQUEsTUFBbUJDLFFBQW5CLFFBQW1CQSxRQUFuQjtBQUFBLE1BQTZCQyxZQUE3QixRQUE2QkEsWUFBN0I7QUFBQSxzQkFDbkQsNERBQ0dDLE1BQU0sQ0FBQ0MsSUFBUCxDQUFZTCxLQUFLLENBQUNDLE9BQUQsQ0FBakIsRUFBNEJLLEdBQTVCLENBQWdDLFVBQUFDLFNBQVMsRUFBSTtBQUM1QyxRQUFNQyxJQUFJLEdBQUdDLHFCQUFVUixPQUFWLENBQWI7QUFDQSxRQUFJLENBQUNPLElBQUwsRUFBVyxPQUFPLElBQVA7QUFFWCx3QkFDRSw2QkFBQyxvQkFBRDtBQUNFLE1BQUEsVUFBVSxFQUFDLFFBRGI7QUFFRSxNQUFBLE9BQU8sRUFBQyxJQUZWO0FBR0UsTUFBQSxFQUFFLEVBQUMs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biAgU3VtbWFyeSxcbiAgRGV0YWlsc0NvbnRlbnQsXG4gIEdyaWRMYXlvdXQsXG4gIFRoZW1lLFxuICBOdW1iZXJJbnB1dCxcbiAgUmFuZ2VJbnB1dCxcbiAgVGV4dCxcbiAgRHJvcGRvd24sXG4gIERyb3Bkb3duTGFiZWwsXG4gIERyb3Bkb3duTWVudSxcbiAgRHJvcGRvd25NZW51SXRlbSxcbiAgSW5wdXRcbn0gZnJvbSAnQGRlaXR5L2ZhbGNvbi11aSc7XG5pbXBvcnQgeyB0aGVtZUNhdGVnb3JpZXMsIHRoZW1lTWV0YSB9IGZyb20gJy4vdGhlbWVtZXRhJztcbmltcG9ydCB7IGZvbnRzIH0gZnJvbSAnLi9mb250cyc7XG5cbnR5cGUgVGhlbWVQcm9wc0VkaXRvclByb3BzID0ge1xuICBvcGVuUGFuZWxzOiB7XG4gICAgW25hbWU6IHN0cmluZ106IGJvb2xlYW47XG4gIH07XG4gIHRoZW1lOiBUaGVtZTtcbiAgdG9nZ2xlT3BlblBhbmVsOiAocGFuZWxLZXk6IHN0cmluZykgPT4gdm9pZDtcbiAgb25DaGFuZ2U6IChcbiAgICB0aGVtZUtleTogc3RyaW5nLFxuICAgIHByb3BOYW1lOiBzdHJpbmcsXG4gICAgaXNOdW1iZXI/OiBib29sZWFuXG4gICkgPT4gKGU6IFJlYWN0LkNoYW5nZUV2ZW50PEhUTUxJbnB1dEVsZW1lbnQ+KSA9PiB2b2lkO1xuICBvbkZvbnRDaGFuZ2U6IChmb250S2luZDogc3RyaW5nKSA9PiAoZm9udE9wdGlvbjogYW55KSA9PiB2b2lkO1xufTtcblxudHlwZSBFZGl0b3JTZWN0aW9uUHJvcHMgPSB7XG4gIHNlY3Rpb246IGtleW9mIFRoZW1lO1xuICB0aGVtZTogVGhlbWU7XG4gIG9uQ2hhbmdlOiAoXG4gICAgdGhlbWVLZXk6IHN0cmluZyxcbiAgICBwcm9wTmFtZTogc3RyaW5nLFxuICAgIGlzTnVtYmVyPzogYm9vbGVhblxuICApID0+IChlOiBSZWFjdC5DaGFuZ2VFdmVudDxIVE1MSW5wdXRFbGVtZW50PikgPT4gdm9pZDtcbiAgb25Gb250Q2hhbmdlOiAoZm9udEtpbmQ6IHN0cmluZykgPT4gKGZvbnRPcHRpb246IGFueSkgPT4gdm9pZDtcbn07XG5cbmNvbnN0IEVkaXRvclNlY3Rpb246IFJlYWN0LlNGQzxFZGl0b3JTZWN0aW9uUHJvcHM+ID0gKHsgdGhlbWUsIHNlY3Rpb24sIG9uQ2hhbmdlLCBvbkZvbnRDaGFuZ2UgfSkgPT4gKFxuICA8PlxuICAgIHtPYmplY3Qua2V5cyh0aGVtZVtzZWN0aW9uXSkubWFwKHRoZW1lUHJvcCA9PiB7XG4gICAgICBjb25zdCBtZXRhID0gdGhlbWVNZXRhW3NlY3Rpb25dO1xuICAgICAgaWYgKCFtZXRhKSByZXR1cm4gbnVsbDtcblxuICAgICAgcmV0dXJuIChcbiAgICAgICAgPEdyaWRMYXlvdXRcbiAgICAgICAgICBhbGlnbkl0ZW1zPVwiY2VudGVyXCJcbiAgICAgICAgICBncmlkR2FwPVwieHNcIlxuICAgICAgICAgIG1iPVwieHNcIlxuICAgICAgICAgIGdyaWRUZW1wbGF0ZUNvbHVtbnM9e21ldGEuaW5wdXQudHlwZSA9PT0gJ2Ryb3Bkb3duJyA/ICc1MHB4IGF1dG8gMS44ZnIgMjBweCcgOiAnMS4xZnIgYXV0byAxLjhmciAzNXB4J31cbiAgICAgICAgICBrZXk9e3RoZW1lUHJvcH1cbiAgICAgICAgPlxuICAgICAgICAgIDxUZXh0IHA9XCJ4c1wiPntgXCIke3RoZW1lUHJvcH1cImB9PC9UZXh0PlxuXG4gICAgICAgICAge21ldGEuaW5wdXQudHlwZSA9PT0gJ251bWJlcicgJiYgKFxuICAgICAgICAgICAgPD5cbiAgICAgICAgICAgICAgPE51bWJlcklucHV0XG4gICAgICAgICAgICAgICAgdmFsdWU9eyh0aGVtZSBhcyBhbnkpW3NlY3Rpb25dW3RoZW1lUHJvcF19XG4gICAgICAgICAgICAgICAgbWluPXttZXRhLmlucHV0Lm1pbn1cbiAgICAgICAgICAgICAgICBtYXg9e21ldGEuaW5wdXQubWF4fVxuICAgICAgICAgICAgICAgIHN0ZXA9e21ldGEuaW5wdXQuc3RlcH1cbiAgICAgICAgICAgICAgICBvbkNoYW5nZT17b25DaGFuZ2Uoc2VjdGlvbiwgdGhlbWVQcm9wLCB0cnVlKX1cbiAgICAgICAgICAgICAgLz5cblxuICAgICAgICAgICAgICA8UmFuZ2VJbnB1dFxuICAgICAgICAgICAgICAgIHZhbHVlPXsodGhlbWUgYXMgYW55KVtzZWN0aW9uXVt0aGVtZVByb3BdfVxuICAgICAgICAgICAgICAgIG1pbj17bWV0YS5pbnB1dC5taW59XG4gICAgICAgICAgICAgICAgbWF4PXttZXRhLmlucHV0Lm1heH1cbiAgICAgICAgICAgICAgICBzdGVwPXttZXRhLmlucHV0LnN0ZXB9XG4gICAgICAgICAgICAgICAgb25DaGFuZ2U9e29uQ2hhbmdlKHNlY3Rpb24sIHRoZW1lUHJvcCwgdHJ1ZSl9XG4gICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgIDxUZXh0IHA9XCJub25lXCIgbWw9XCJ4c1wiIGZvbnRTaXplPVwic21cIj5cbiAgICAgICAgICAgICAgICBweFxuICAgICAgICAgICAgICA8L1RleHQ+XG4gICAgICAgICAgICA8Lz5cbiAgICAgICAgICApfVxuICAgICAgICAgIHttZXRhLmlucHV0LnR5cGUgPT09ICdkcm9wZG93bicgJiYgKFxuICAgICAgICAgICAgPERyb3Bkb3duIG9uQ2hhbmdlPXtvbkZvbnRDaGFuZ2UodGhlbWVQcm9wKX0gZ3JpZENvbHVtbj1cInNwYW4gM1wiPlxuICAgICAgICAgICAgICA8RHJvcGRvd25MYWJlbD57KHRoZW1lIGFzIGFueSlbc2VjdGlvbl1bdGhlbWVQcm9wXX08L0Ryb3Bkb3duTGFiZWw+XG4gICAgICAgICAgICAgIDxEcm9wZG93bk1lbnU+XG4gICAgICAgICAgICAgICAge2ZvbnRzLm1hcChmb250ID0+IChcbiAgICAgICAgICAgICAgICAgIDxEcm9wZG93bk1lbnVJdGVtIGtleT17Zm9udC52YWx1ZX0gdmFsdWU9e2ZvbnR9PlxuICAgICAgICAgICAgICAgICAgICB7YCR7Zm9udC52YWx1ZX0gJHtmb250Lmdvb2dsZSA/ICcgLSAoR29vZ2xlIEZvbnQpJyA6ICcnfWB9XG4gICAgICAgICAgICAgICAgICA8L0Ryb3Bkb3duTWVudUl0ZW0+XG4gICAgICAgICAgICAgICAgKSl9XG4gICAgICAgICAgICAgIDwvRHJvcGRvd25NZW51PlxuICAgICAgICAgICAgPC9Ecm9wZG93bj5cbiAgICAgICAgICApfVxuICAgICAgICAgIHttZXRhLmlucHV0LnR5cGUgPT09ICdjb2xvcicgJiYgKFxuICAgICAgICAgICAgPElucHV0XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXtvbkNoYW5nZShzZWN0aW9uLCB0aGVtZVByb3ApfVxuICAgICAgICAgICAgICB0eXBlPVwiY29sb3JcIlxuICAgICAgICAgICAgICBncmlkQ29sdW1uPVwic3BhbiAyXCJcbiAgICAgICAgICAgICAgdmFsdWU9eyh0aGVtZSBhcyBhbnkpW3NlY3Rpb25dW3RoZW1lUHJvcF19XG4gICAgICAgICAgICAgIGNzcz17e1xuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDAsXG4gICAgICAgICAgICAgICAgd2lkdGg6IDYwLFxuICAgICAgICAgICAgICAgIGJvcmRlclJhZGl1czogMCxcbiAgICAgICAgICAgICAgICBib3JkZXI6ICdub25lJ1xuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICApfVxuXG4gICAgICAgICAge21ldGEuaW5wdXQudHlwZSA9PT0gJ3RleHQnICYmIChcbiAgICAgICAgICAgIDxJbnB1dFxuICAgICAgICAgICAgICBvbkNoYW5nZT17b25DaGFuZ2Uoc2VjdGlvbiwgdGhlbWVQcm9wKX1cbiAgICAgICAgICAgICAgZ3JpZENvbHVtbj1cInNwYW4gM1wiXG4gICAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgdmFsdWU9eyh0aGVtZSBhcyBhbnkpW3NlY3Rpb25dW3RoZW1lUHJvcF19XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvR3JpZExheW91dD5cbiAgICAgICk7XG4gICAgfSl9XG4gIDwvPlxuKTtcblxuZXhwb3J0IGNvbnN0IFRoZW1lUHJvcHNFZGl0b3I6IFJlYWN0LlNGQzxUaGVtZVByb3BzRWRpdG9yUHJvcHM+ID0gKHtcbiAgb3BlblBhbmVscyxcbiAgdG9nZ2xlT3BlblBhbmVsLFxuICB0aGVtZSxcbiAgb25DaGFuZ2UsXG4gIG9uRm9udENoYW5nZVxufSkgPT4gKFxuICA8R3JpZExheW91dCBncmlkR2FwPVwieHNcIj5cbiAgICB7T2JqZWN0LmtleXModGhlbWVDYXRlZ29yaWVzKS5tYXAoY2F0ZWdvcnlLZXkgPT4ge1xuICAgICAgY29uc3QgY2F0ZWdvcnkgPSB0aGVtZUNhdGVnb3JpZXNbY2F0ZWdvcnlLZXldO1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgPERldGFpbHMga2V5PXtjYXRlZ29yeS5uYW1lfSBvcGVuPXtvcGVuUGFuZWxzW2NhdGVnb3J5S2V5XX0+XG4gICAgICAgICAgPFN1bW1hcnlcbiAgICAgICAgICAgIG9uQ2xpY2s9e2UgPT4ge1xuICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgIHRvZ2dsZU9wZW5QYW5lbChjYXRlZ29yeUtleSk7XG4gICAgICAgICAgICB9fVxuICAgICAgICAgID5cbiAgICAgICAgICAgIHtjYXRlZ29yeS5uYW1lfVxuICAgICAgICAgIDwvU3VtbWFyeT5cblxuICAgICAgICAgIHtvcGVuUGFuZWxzW2NhdGVnb3J5S2V5XSAmJiAoXG4gICAgICAgICAgICA8RGV0YWlsc0NvbnRlbnQgcHI9XCJ4c1wiPlxuICAgICAgICAgICAgICB7Y2F0ZWdvcnkudGhlbWVTZWN0aW9ucy5sZW5ndGggPT09IDEgJiYgKFxuICAgICAgICAgICAgICAgIDxFZGl0b3JTZWN0aW9uXG4gICAgICAgICAgICAgICAgICBzZWN0aW9uPXtjYXRlZ29yeS50aGVtZVNlY3Rpb25zWzBdfVxuICAgICAgICAgICAgICAgICAgdGhlbWU9e3RoZW1lfVxuICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e29uQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgb25Gb250Q2hhbmdlPXtvbkZvbnRDaGFuZ2V9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgICB7Y2F0ZWdvcnkudGhlbWVTZWN0aW9ucy5sZW5ndGggPiAxICYmXG4gICAgICAgICAgICAgICAgY2F0ZWdvcnkudGhlbWVTZWN0aW9ucy5tYXAoc2VjdGlvbiA9PiB7XG4gICAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBjYXRlZ29yeUtleSArIHNlY3Rpb247XG5cbiAgICAgICAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICAgIDxEZXRhaWxzIG1iPVwic21cIiBrZXk9e2tleX0gb3Blbj17b3BlblBhbmVsc1trZXldfT5cbiAgICAgICAgICAgICAgICAgICAgICA8U3VtbWFyeVxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17ZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdG9nZ2xlT3BlblBhbmVsKGtleSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtzZWN0aW9ufVxuICAgICAgICAgICAgICAgICAgICAgIDwvU3VtbWFyeT5cbiAgICAgICAgICAgICAgICAgICAgICA8RGV0YWlsc0NvbnRlbnQgbXI9XCJ4c1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPEVkaXRvclNlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2VjdGlvbj17c2VjdGlvbn1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlbWU9e3RoZW1lfVxuICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17b25DaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uRm9udENoYW5nZT17b25Gb250Q2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICA8L0RldGFpbHNDb250ZW50PlxuICAgICAgICAgICAgICAgICAgICA8L0RldGFpbHM+XG4gICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgPC9EZXRhaWxzQ29udGVudD5cbiAgICAgICAgICApfVxuICAgICAgICA8L0RldGFpbHM+XG4gICAgICApO1xuICAgIH0pfVxuICA8L0dyaWRMYXlvdXQ+XG4pO1xuIl19