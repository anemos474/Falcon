"use strict";

exports.__esModule = true;
exports.apolloStateToObject = apolloStateToObject;

/**
 * This method expands flatten Apollo cache value into a nested object
 * @param {object} state Apollo state object
 * @param {string} stateKey Apollo state key
 * @returns {object} Expanded object
 */
function apolloStateToObject(state, stateKey) {
  var result = Object.assign({}, state[stateKey]);
  Object.keys(result).forEach(function (key) {
    var value = result[key];

    if (!value) {
      return;
    }

    if (Array.isArray(value)) {
      result[key] = value.filter(function (item) {
        return item && typeof item === 'object' && item.generated && item.id;
      }).map(function (item) {
        return apolloStateToObject(state, item.id);
      });
    } else if (typeof value === 'object') {
      if (value.generated && value.id) {
        result[key] = apolloStateToObject(state, value.id);
      } else if (value.type === 'json') {
        result[key] = value.json;
      }
    }
  });
  return result;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9BcG9sbG8vYXBvbGxvU3RhdGVUb09iamVjdC50cyJdLCJuYW1lcyI6WyJhcG9sbG9TdGF0ZVRvT2JqZWN0Iiwic3RhdGUiLCJzdGF0ZUtleSIsInJlc3VsdCIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwia2V5IiwidmFsdWUiLCJBcnJheSIsImlzQXJyYXkiLCJmaWx0ZXIiLCJpdGVtIiwiZ2VuZXJhdGVkIiwiaWQiLCJtYXAiLCJ0eXBlIiwianNvbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTyxTQUFTQSxtQkFBVCxDQUE2QkMsS0FBN0IsRUFBNENDLFFBQTVDLEVBQXNFO0FBQzNFLE1BQU1DLE1BQU0scUJBQVFGLEtBQUssQ0FBQ0MsUUFBRCxDQUFiLENBQVo7QUFFQUUsRUFBQUEsTUFBTSxDQUFDQyxJQUFQLENBQVlGLE1BQVosRUFBb0JHLE9BQXBCLENBQTRCLFVBQUFDLEdBQUcsRUFBSTtBQUNqQyxRQUFNQyxLQUFLLEdBQUdMLE1BQU0sQ0FBQ0ksR0FBRCxDQUFwQjs7QUFFQSxRQUFJLENBQUNDLEtBQUwsRUFBWTtBQUNWO0FBQ0Q7O0FBRUQsUUFBSUMsS0FBSyxDQUFDQyxPQUFOLENBQWNGLEtBQWQsQ0FBSixFQUEwQjtBQUN4QkwsTUFBQUEsTUFBTSxDQUFDSSxHQUFELENBQU4sR0FBY0MsS0FBSyxDQUNoQkcsTUFEVyxDQUNKLFVBQUFDLElBQUk7QUFBQSxlQUFJQSxJQUFJLElBQUksT0FBT0EsSUFBUCxLQUFnQixRQUF4QixJQUFvQ0EsSUFBSSxDQUFDQyxTQUF6QyxJQUFzREQsSUFBSSxDQUFDRSxFQUEvRDtBQUFBLE9BREEsRUFFWEMsR0FGVyxDQUVQLFVBQUFILElBQUk7QUFBQSxlQUFJWixtQkFBbUIsQ0FBQ0MsS0FBRCxFQUFRVyxJQUFJLENBQUNFLEVBQWIsQ0FBdkI7QUFBQSxPQUZHLENBQWQ7QUFHRCxLQUpELE1BSU8sSUFBSSxPQUFPTixLQUFQLEtBQWlCLFFBQXJCLEVBQStCO0FBQ3BDLFVBQUlBLEtBQUssQ0FBQ0ssU0FBTixJQUFtQkwsS0FBSyxDQUFDTSxFQUE3QixFQUFpQztBQUMvQlgsUUFBQUEsTUFBTSxDQUFDSSxHQUFELENBQU4sR0FBY1AsbUJBQW1CLENBQUNDLEtBQUQsRUFBUU8sS0FBSyxDQUFDTSxFQUFkLENBQWpDO0FBQ0QsT0FGRCxNQUVPLElBQUlOLEtBQUssQ0FBQ1EsSUFBTixLQUFlLE1BQW5CLEVBQTJCO0FBQ2hDYixRQUFBQSxNQUFNLENBQUNJLEdBQUQsQ0FBTixHQUFjQyxLQUFLLENBQUNTLElBQXBCO0FBQ0Q7QUFDRjtBQUNGLEdBbEJEO0FBb0JBLFNBQU9kLE1BQVA7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGhpcyBtZXRob2QgZXhwYW5kcyBmbGF0dGVuIEFwb2xsbyBjYWNoZSB2YWx1ZSBpbnRvIGEgbmVzdGVkIG9iamVjdFxuICogQHBhcmFtIHtvYmplY3R9IHN0YXRlIEFwb2xsbyBzdGF0ZSBvYmplY3RcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdGF0ZUtleSBBcG9sbG8gc3RhdGUga2V5XG4gKiBAcmV0dXJucyB7b2JqZWN0fSBFeHBhbmRlZCBvYmplY3RcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFwb2xsb1N0YXRlVG9PYmplY3Qoc3RhdGU6IG9iamVjdCwgc3RhdGVLZXk6IHN0cmluZyk6IG9iamVjdCB7XG4gIGNvbnN0IHJlc3VsdCA9IHsgLi4uc3RhdGVbc3RhdGVLZXldIH07XG5cbiAgT2JqZWN0LmtleXMocmVzdWx0KS5mb3JFYWNoKGtleSA9PiB7XG4gICAgY29uc3QgdmFsdWUgPSByZXN1bHRba2V5XTtcblxuICAgIGlmICghdmFsdWUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgIHJlc3VsdFtrZXldID0gdmFsdWVcbiAgICAgICAgLmZpbHRlcihpdGVtID0+IGl0ZW0gJiYgdHlwZW9mIGl0ZW0gPT09ICdvYmplY3QnICYmIGl0ZW0uZ2VuZXJhdGVkICYmIGl0ZW0uaWQpXG4gICAgICAgIC5tYXAoaXRlbSA9PiBhcG9sbG9TdGF0ZVRvT2JqZWN0KHN0YXRlLCBpdGVtLmlkKSk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XG4gICAgICBpZiAodmFsdWUuZ2VuZXJhdGVkICYmIHZhbHVlLmlkKSB7XG4gICAgICAgIHJlc3VsdFtrZXldID0gYXBvbGxvU3RhdGVUb09iamVjdChzdGF0ZSwgdmFsdWUuaWQpO1xuICAgICAgfSBlbHNlIGlmICh2YWx1ZS50eXBlID09PSAnanNvbicpIHtcbiAgICAgICAgcmVzdWx0W2tleV0gPSB2YWx1ZS5qc29uO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbiJdfQ==